<article xmlns="http://dtd.nlm.nih.gov/2.0/xsd/archivearticle" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://dtd.nlm.nih.gov/2.0/xsd/archivearticle http://dtd.nlm.nih.gov/2.0/xsd/archivearticle.xsd" article-type="research-article">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">Med Image Anal</journal-id>
      <journal-title-group>
        <journal-title>Medical Image Analysis</journal-title>
      </journal-title-group>
      <issn pub-type="ppub">1361-8415</issn>
      <issn pub-type="epub">1361-8423</issn>
      <publisher>
        <publisher-name>Elsevier</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="pmc">2868358</article-id>
      <article-id pub-id-type="pmid">20163980</article-id>
      <article-id pub-id-type="publisher-id">MEDIMA493</article-id>
      <article-id pub-id-type="doi">10.1016/j.media.2010.01.003</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Article</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>High resolution cortical bone thickness measurement from clinical CT data</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Treece</surname>
            <given-names>G.M.</given-names>
          </name>
          <email>gmt11@cam.ac.uk</email>
          <xref rid="aff1" ref-type="aff">a</xref>
          <xref rid="cor1" ref-type="corresp">⁎</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Gee</surname>
            <given-names>A.H.</given-names>
          </name>
          <email>ahg@cam.ac.uk</email>
          <xref rid="aff1" ref-type="aff">a</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Mayhew</surname>
            <given-names>P.M.</given-names>
          </name>
          <email>pmm35@cam.ac.uk</email>
          <xref rid="aff2" ref-type="aff">b</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Poole</surname>
            <given-names>K.E.S.</given-names>
          </name>
          <email>kenpoole@doctors.org.uk</email>
          <xref rid="aff2" ref-type="aff">b</xref>
        </contrib>
      </contrib-group>
      <aff id="aff1"><label>a</label>University of Cambridge Department of Engineering, Trumpington Street, Cambridge CB2 1PZ, UK</aff>
      <aff id="aff2"><label>b</label>University of Cambridge Department of Medicine, Level 5, Addenbrooke’s Hospital (Box 157), Hills Road, Cambridge CB2 2QQ, UK</aff>
      <author-notes>
        <corresp id="cor1"><label>⁎</label>Corresponding author. Tel.: +44 1223 339707; fax: +44 1223 332662. <email>gmt11@cam.ac.uk</email></corresp>
      </author-notes>
      <pub-date pub-type="pmc-release">
        <month>6</month>
        <year>2010</year>
      </pub-date>
      <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="ppub"/>. -->
      <pub-date pub-type="ppub">
        <month>6</month>
        <year>2010</year>
      </pub-date>
      <volume>14</volume>
      <issue>3</issue>
      <fpage>276</fpage>
      <lpage>290</lpage>
      <history>
        <date date-type="received">
          <day>15</day>
          <month>10</month>
          <year>2009</year>
        </date>
        <date date-type="rev-recd">
          <day>14</day>
          <month>1</month>
          <year>2010</year>
        </date>
        <date date-type="accepted">
          <day>18</day>
          <month>1</month>
          <year>2010</year>
        </date>
      </history>
      <permissions>
        <copyright-statement>© 2010 Elsevier B.V.</copyright-statement>
        <copyright-year>2010</copyright-year>
        <copyright-holder>Elsevier B.V.</copyright-holder>
        <license>
          <license-p>This document may be redistributed and reused, subject to <ext-link ext-link-type="uri" xlink:href="http://www.elsevier.com/wps/find/authorsview.authors/supplementalterms1.0">certain conditions</ext-link>.</license-p>
        </license>
      </permissions>
      <abstract>
        <p>The distribution of cortical bone in the proximal femur is believed to be a critical component in determining fracture resistance. Current CT technology is limited in its ability to measure cortical thickness, especially in the sub-millimetre range which lies within the point spread function of today’s clinical scanners. In this paper, we present a novel technique that is capable of producing unbiased thickness estimates down to 0.3 mm. The technique relies on a mathematical model of the anatomy and the imaging system, which is fitted to the data at a large number of sites around the proximal femur, producing around 17,000 independent thickness estimates per specimen. In a series of experiments on 16 cadaveric femurs, estimation errors were measured as −0.01 ± 0.58 mm (mean ± 1 std.dev.) for cortical thicknesses in the range 0.3–4 mm. This compares with 0.25 ± 0.69 mm for simple thresholding and 0.90 ± 0.92 mm for a variant of the 50% relative threshold method. In the clinically relevant sub-millimetre range, thresholding increasingly fails to detect the cortex at all, whereas the new technique continues to perform well. The many cortical thickness estimates can be displayed as a colour map painted onto the femoral surface. Computation of the surfaces and colour maps is largely automatic, requiring around 15 min on a modest laptop computer.</p>
      </abstract>
      <kwd-group>
        <title>Keywords</title>
        <kwd>Cortical bone</kwd>
        <kwd>Osteoporosis</kwd>
        <kwd>Hip fracture</kwd>
      </kwd-group>
    </article-meta>
  </front>
  <body>
    <sec>
      <label>1</label>
      <title>Introduction</title>
      <p>The exponential increase in hip fractures with ageing imposes a substantial and increasing health burden. They are the most common reason for acute orthopaedic admission in older people (<xref rid="bib18" ref-type="bibr">Parker and Johansen, 2006</xref>) and their incidence is projected to rise worldwide from 1.7 million in 1990 to 6.3 million in 2050 (<xref rid="bib23" ref-type="bibr">Sambrook and Cooper, 2006</xref>). Current imaging methods for predicting an individuals hip fracture risk use bone mineral density (BMD) estimates which are specific (<xref rid="bib11 bib12" ref-type="bibr">Johnell et al., 2005; Kanis et al., 2008</xref>) but have low sensitivity (<xref rid="bib12 bib13 bib24" ref-type="bibr">Kanis et al., 2008; Kaptoge et al., 2008; Sanders et al., 2006</xref>). Regional structural weakness in the aged hip may predispose to fracture (<xref rid="bib15 bib20 bib6" ref-type="bibr">Mayhew et al., 2005; Poole et al., 2009; de Bakker et al., 2009</xref>) and there have been numerous calls to develop novel three-dimensional (3D) methods of assessing hip structure, most notably with multi-detector computed tomography, MDCT (<xref rid="bib2" ref-type="bibr">Bouxsein and Delmas, 2008</xref>).</p>
      <p>The anatomical distribution of cortical bone in the aged proximal femoral metaphysis is a critical component in determining its resistance to fracture, with trabecular bone playing a lesser role (<xref rid="bib10 bib29" ref-type="bibr">Holzer et al., 2009; Verhulp et al., 2008</xref>). Compressive cracking of cortical bone of the superior parts of the neck and trochanter is often the first stage of fracture (<xref rid="bib6 bib5 bib15" ref-type="bibr">de Bakker et al., 2009; Carpenter et al., 2005; Mayhew et al., 2005</xref>). Current MDCT studies are anatomically limited by set regions of interest and technically limited by thresholding errors caused by relatively low resolution data sets. Ideally, we would like to be able to map the cortical bone thickness to a high degree of accuracy, from a clinical resolution data set, over the entire proximal femur. Since bone anabolic drugs are capable of stimulating new bone formation at structurally important sites (<xref rid="bib14 bib28" ref-type="bibr">Keaveny et al., 2008; Uusi-Rasi et al., 2005</xref>), such a technique might help not only with identification of weak areas but also in assessing treatment response.</p>
      <p>Thin laminar structures such as the femoral cortex are not accurately depicted in clinical CT because of the images’ limited spatial resolution. This typically results in an underestimate of density and an overestimate of thickness. A number of studies (<xref rid="bib7 bib9 bib21" ref-type="bibr">Dougherty and Newman, 1999; Hangartner and Gilsanz, 1996; Prevrhal et al., 1999</xref>) have investigated the influence of the imaging system’s in-plane point spread function (PSF), while <xref rid="bib22" ref-type="bibr">Prevrhal et al. (2003)</xref> go further in quantifying the effects of the out-of-plane PSF as well. Such studies explain why straightforward thickness estimation techniques, such as those based on thresholding (<xref rid="bib3 bib8" ref-type="bibr">Buie et al., 2007; Hangartner, 2007</xref>) or the 50% relative threshold method (<xref rid="bib21 bib22" ref-type="bibr">Prevrhal et al., 1999, 2003</xref>, described in Section <xref rid="sec2" ref-type="sec">2.2</xref>), are unreliable when the structure is thin compared with the imaging system’s PSF. The consensus is that, with typical PSFs from normal bore, clinical CT scanners, straightforward thickness measurements start to become inaccurate below around 2.5 mm (<xref rid="bib7 bib9" ref-type="bibr">Dougherty and Newman, 1999; Hangartner and Gilsanz, 1996</xref>), with errors exceeding 100% for sub-millimetre cortices (<xref rid="bib22" ref-type="bibr">Prevrhal et al., 2003</xref>).</p>
      <p>More sophisticated thickness estimation techniques are capable of superior accuracy and precision. The classical approach to image deblurring is to assume models of both the object being scanned and the image formation process, then attempt to fit these models to the data. Often, this inverse problem is ill-posed, in that no unique set of model parameters explains the data, especially in the presence of imaging noise. In such circumstances, prior knowledge may be used to constrain some of the model parameters. Such an approach was used by <xref rid="bib25" ref-type="bibr">Streekstra et al. (2007)</xref> to estimate the thickness of cartilage layers in the sub-millimetre range, well below the nominal width of the CT system’s PSF. In this instance, the model parameters relating to the PSF were fixed, using information obtained by scanning a suitable phantom.</p>
      <p>In this paper, we describe a model-based approach for measuring femoral cortical bone thicknesses in the supra- to sub-millimetre range, using standard, normal bore, clinical CT. We employ the anatomical and imaging models described by <xref rid="bib22" ref-type="bibr">Prevrhal et al. (2003)</xref>, and explore the efficacy of constraining various parameters when fitting these models to the CT data. In contrast to the approach taken by <xref rid="bib25" ref-type="bibr">Streekstra et al. (2007)</xref>, we find that constraining the peak CT density, rather than the imaging system’s PSF, produces the best cortical thickness estimates. Our model-fitting process is guided by a semi-automatic segmentation of the outer bone surface. This leads to an illuminating way of visualizing the results: cortical thicknesses can be displayed, to high spatial resolution, as a colour map painted on the bone surface.</p>
      <p>The paper is organised as follows. In Section <xref rid="sec1" ref-type="sec">2</xref>, we recap the anatomical and imaging models of <xref rid="bib22" ref-type="bibr">Prevrhal et al. (2003)</xref>, describe our novel approach for fitting these models to low resolution CT data, and introduce our methodology for evaluating the results. In Section <xref rid="sec5" ref-type="sec">3</xref>, we present results for 16 cadaveric human femurs, scanned using both high resolution, peripheral CT and conventional, low resolution CT. Cortical thicknesses measured by a 50% relative threshold technique on the high resolution data provide the ground truth against which estimates from the low resolution data are judged. By way of comparison, results are presented for the new method and also the thresholding and 50% relative threshold approaches. These results are discussed in Section <xref rid="sec7" ref-type="sec">4</xref>, before we draw our conclusions and suggest some avenues for future research in Section <xref rid="sec8" ref-type="sec">5</xref>.</p>
    </sec>
    <sec sec-type="methods" id="sec1">
      <label>2</label>
      <title>Method</title>
      <sec>
        <label>2.1</label>
        <title>Modelling the scanning process</title>
        <p>We use as our raw data for each cortical thickness estimate the CT values along a line in the imaging plane normal to the cortical layer, and of sufficient length to pass through both the cortical layer itself and any blurred prolongation caused by the imaging process. A convenient method for locating such lines is discussed in Section <xref rid="sec3" ref-type="sec">2.3</xref>. We assume that the cortical layer is locally flat and of uniform thickness, at least within the extent of the imaging system’s PSF. We can then model the CT values along the line as a convolution of the ‘real’ density with an in-plane and an out-of-plane PSF. The real density variation <italic>y</italic> over distance <italic>x</italic> is assumed to be piecewise constant, with different values in the surrounding tissue, the cortex and the trabecular bone. This can be expressed as the summation of two step functions:<disp-formula id="fd4"><label>(1)</label><alternatives><textual-form specific-use="jats-markup"><italic>y</italic>(<italic>x</italic>) = <italic>y</italic><sub>0</sub> + (<italic>y</italic><sub>1</sub> - <italic>y</italic><sub>0</sub>)<italic>H</italic>(<italic>x</italic> - <italic>x</italic><sub>0</sub>) + (<italic>y</italic><sub>2</sub> - <italic>y</italic><sub>1</sub>)<italic>H</italic>(<italic>x</italic> - <italic>x</italic><sub>1</sub>)</textual-form><mml:math id="M1" altimg="si11.gif" overflow="scroll"><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></disp-formula>where <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>0</sub>,<italic>y</italic><sub>1</sub></textual-form><mml:math id="M2" altimg="si12.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>2</sub></textual-form><mml:math id="M3" altimg="si13.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> are the CT values in the surrounding tissue, cortical and trabecular bone, respectively, <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>x</italic><sub>0</sub></textual-form><mml:math id="M4" altimg="si14.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>x</italic><sub>1</sub></textual-form><mml:math id="M5" altimg="si15.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> are the locations of the outer and inner cortical surfaces, and <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>H</italic>(<italic>x</italic>)</textual-form><mml:math id="M6" altimg="si16.gif" overflow="scroll"><mml:mrow><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is a unit step function.</p>
        <p>Following the approach taken by <xref rid="bib22" ref-type="bibr">Prevrhal et al. (2003)</xref>, we model the in-plane PSF <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>g</italic><sub><italic>i</italic></sub></textual-form><mml:math id="M7" altimg="si17.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> as a normalised Gaussian function:<disp-formula><label>(2)</label><mml:math id="M8" altimg="si18.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:msqrt><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:math></disp-formula>where <italic>σ</italic> represents the extent of the blur. The out-of-plane PSF <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>g</italic><sub><italic>o</italic></sub></textual-form><mml:math id="M9" altimg="si19.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the result of the interaction between the CT slice thickness and the orientation of the cortical layer with respect to the imaging plane, as illustrated in <xref rid="fig1" ref-type="fig">Fig. 1</xref>. This can be expressed as a rectangular function:<disp-formula><label>(3)</label><alternatives><textual-form specific-use="jats-markup"><italic>g</italic><sub><italic>o</italic></sub>(<italic>x</italic>) = ½[<italic>H</italic>(<italic>x</italic> + <italic>r</italic>) - <italic>H</italic>(<italic>x</italic> - <italic>r</italic>)]</textual-form><mml:math id="M10" altimg="si20.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">[</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:math></alternatives></disp-formula>where the extent of blur <inline-formula><alternatives><textual-form specific-use="jats-markup">2<italic>r</italic></textual-form><mml:math id="M11" altimg="si21.gif" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is calculated from <italic>s</italic>, the CT slice thickness, and <italic>a</italic>, the angle the cortical surface normal makes with the imaging plane:<disp-formula id="fd8"><label>(4)</label><mml:math id="M12" altimg="si22.gif" overflow="scroll"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">tan</mml:mi><mml:mi>a</mml:mi></mml:math></disp-formula></p>
        <p>Hence, the fully blurred CT values <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>blur</sub></textual-form><mml:math id="M13" altimg="si23.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext>blur</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> are given by<xref rid="fn1" ref-type="fn">1</xref>:<disp-formula id="fd1"><label>(5)</label><mml:math id="M14" altimg="si29.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext>blur</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>∫</mml:mo><mml:mo>∫</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>r</mml:mi><mml:mi>σ</mml:mi><mml:msqrt><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mrow><mml:mfenced open="[" close="]"><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mi> </mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mi> </mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>r</mml:mi><mml:mi>σ</mml:mi><mml:msqrt><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mrow><mml:mfenced open="[" close="]"><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mi> </mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mi> </mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mtext>d</mml:mtext><mml:mi>x</mml:mi><mml:mspace width="0.12em"/><mml:mtext>d</mml:mtext><mml:mi>x</mml:mi></mml:math></disp-formula>except for the special case <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>r</italic> = 0</textual-form><mml:math id="M15" altimg="si30.gif" overflow="scroll"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, when:<disp-formula id="fd2"><label>(6)</label><mml:math id="M16" altimg="si31.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext>blur, r=0</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>∫</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:msqrt><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mi> </mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:msqrt><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mi> </mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mtext>d</mml:mtext><mml:mi>x</mml:mi></mml:math></disp-formula></p>
        <p>The true cortical thickness <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>t</italic><sub><italic>r</italic></sub></textual-form><mml:math id="M17" altimg="si32.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is then:<disp-formula id="fd6"><label>(7)</label><alternatives><textual-form specific-use="jats-markup"><italic>t</italic><sub><italic>r</italic></sub> = <italic>t</italic><sub><italic>m</italic></sub>cos<italic>a</italic> = (<italic>x</italic><sub>1</sub> - <italic>x</italic><sub>0</sub>)cos<italic>a</italic></textual-form><mml:math id="M18" altimg="si33.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">cos</mml:mi><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">cos</mml:mi><mml:mi>a</mml:mi></mml:math></alternatives></disp-formula>where <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>t</italic><sub><italic>m</italic></sub></textual-form><mml:math id="M19" altimg="si34.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the measured in-plane thickness (<xref rid="fig1" ref-type="fig">Fig. 1</xref>).</p>
        <p><xref rid="fig2" ref-type="fig">Fig. 2</xref> shows <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>blur</sub></textual-form><mml:math id="M20" altimg="si35.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext>blur</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> for the case <italic>σ</italic> = 1 mm and <italic>r</italic> = 0, and with cortical thickness values of 5 mm, 1 mm and 0.5 mm. When the cortex is thin, as in <xref rid="fig2" ref-type="fig">Fig. 2</xref>c, thickness estimation using a set threshold, or the 50% relative threshold method, is highly error prone. <xref rid="bib22" ref-type="bibr">Prevrhal et al. (2003)</xref> demonstrated that Eq. <xref rid="fd1" ref-type="disp-formula">(5)</xref> is a good model for what is typically observed when estimating cortical thickness in practice. The real examples in <xref rid="fig3" ref-type="fig">Fig. 3</xref> confirm that the imaging process for low resolution clinical data does indeed follow the model fairly closely. The equivalent high resolution data indicates that the ‘real’ density variation is reasonably well modeled by the piecewise constant function of Eq. <xref rid="fd4" ref-type="disp-formula">(1)</xref>, though clearly the CT values on either side of the cortex are not perfectly flat.</p>
      </sec>
      <sec id="sec2">
        <label>2.2</label>
        <title>Thickness estimation</title>
        <p>If we could fit the model of Eq. <xref rid="fd1" ref-type="disp-formula">(5)</xref> to real CT data, then we could derive the cortical thickness <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>t</italic><sub><italic>r</italic></sub></textual-form><mml:math id="M21" altimg="si36.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> using Eq. <xref rid="fd6" ref-type="disp-formula">(7)</xref> and knowledge of the surface orientation. This potentially allows thickness measurement well below the blurring level <italic>σ</italic> of the imaging process. Fitted models are shown as dashed lines in <xref rid="fig3" ref-type="fig">Fig. 3</xref>c and d. For the high resolution data, the dashed lines follow the edges of the cortex well, despite the distracting density variations elsewhere. For the low resolution data, the dashed lines are nearly indistinguishable from the real data (solid lines), providing further evidence of the model’s validity.</p>
        <p>In our proposed method, optimization of the model parameters is performed using the Levenberg-Marquardt method (<xref rid="bib16" ref-type="bibr">More, 1977</xref>). The CT data is resampled at 100 points along the line in the image plane normal to the cortical surface, using a Mitchell-Netravali cubic spline (<xref rid="bib4" ref-type="bibr">Burger and Burge, 2009</xref>) to interpolate between the original CT samples. Automatic positioning of this line is discussed in Section <xref rid="sec3" ref-type="sec">2.3</xref>. The model is then fitted to the 100 new samples, with Eq. <xref rid="fd1" ref-type="disp-formula">(5)</xref> evaluated numerically for each candidate set of parameters. Model-data discrepancies at one end of the line (that closest to the outer cortical surface) are penalised slightly more than discrepancies elsewhere. This encourages the optimization algorithm to fit the model to the actual cortex, and not to secondary CT peaks within the interior that are especially common in high resolution data.</p>
        <p>There are seven parameters, <inline-formula><alternatives><textual-form specific-use="jats-markup">(<italic>y</italic><sub>0</sub>, <italic>y</italic><sub>1</sub>, <italic>y</italic><sub>2</sub>, <italic>x</italic><sub>0</sub>, <italic>x</italic><sub>1</sub>, σ, <italic>r</italic>)</textual-form><mml:math id="M22" altimg="si37.gif" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:mspace width="0.35em"/><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:mspace width="0.35em"/><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:mspace width="0.35em"/><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:mspace width="0.35em"/><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:mspace width="0.35em"/><mml:mi>σ</mml:mi><mml:mtext>,</mml:mtext><mml:mspace width="0.35em"/><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, in the model. Of these, the out-of-plane blur <italic>r</italic> is assumed to be known from the surface orientation (see Section <xref rid="sec3" ref-type="sec">2.3</xref>) and the slice thickness, following Eq. <xref rid="fd8" ref-type="disp-formula">(4)</xref>. The edges of the cortical layer <inline-formula><alternatives><textual-form specific-use="jats-markup">(<italic>x</italic><sub>0</sub>, <italic>x</italic><sub>1</sub>)</textual-form><mml:math id="M23" altimg="si38.gif" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:mspace width="0.35em"/><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> are the values we are attempting to estimate. This leaves three parameters <inline-formula><alternatives><textual-form specific-use="jats-markup">(<italic>y</italic><sub>0</sub>, <italic>y</italic><sub>1</sub>, <italic>y</italic><sub>2</sub>)</textual-form><mml:math id="M24" altimg="si39.gif" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:mspace width="0.35em"/><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:mspace width="0.35em"/><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> describing the CT values, and one, <italic>σ</italic>, describing the in-plane PSF. The CT values of the surrounding tissue <inline-formula><alternatives><textual-form specific-use="jats-markup">(<italic>y</italic><sub>0</sub>)</textual-form><mml:math id="M25" altimg="si40.gif" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and of the trabecular bone <inline-formula><alternatives><textual-form specific-use="jats-markup">(<italic>y</italic><sub>2</sub>)</textual-form><mml:math id="M26" altimg="si41.gif" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> vary with location around the proximal femur, so we leave the model free to discover these parameters for each individual line. This requires that the line penetrates each region sufficiently: we therefore set the line length to at least three times the maximum cortical thickness we expect to encounter, and position it so that one-third lies outside the exterior cortical surface. For the experiments reported in Section <xref rid="sec5" ref-type="sec">3</xref>, the line length was about 18 mm in all cases (6 mm outside, 12 mm inside).</p>
        <p>The remaining two model parameters, <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>1</sub></textual-form><mml:math id="M27" altimg="si42.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, the cortical CT value, and <italic>σ</italic>, the in-plane blur, are more problematic. For thin cortical layers, it is possible to trade one off against the other to produce values of <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>blur</sub></textual-form><mml:math id="M28" altimg="si43.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext>blur</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> that are very similar. In other words, the problem is ill-posed. When both these parameters are left free, the Levenberg-Marquardt method frequently fails to converge, and there is much variability in the subsequent thickness estimates. To better condition the optimization problem, we could constrain either <italic>σ</italic>, as was done for the more complex cartilage model of <xref rid="bib25" ref-type="bibr">Streekstra et al. (2007)</xref>, or <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>1</sub></textual-form><mml:math id="M29" altimg="si44.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. Neither choice is ideal, since both <italic>σ</italic> and <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>1</sub></textual-form><mml:math id="M30" altimg="si45.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> are expected to vary with location around the proximal femur. While it might seem more natural to constrain <italic>σ</italic>, it transpires that this barely improves the conditioning of the problem. In contrast, constraining <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>1</sub></textual-form><mml:math id="M31" altimg="si46.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is far more effective. The evidence for this assertion can be found in Section <xref rid="sec5" ref-type="sec">3</xref>, where we subsequently assess two approaches for setting <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>1</sub></textual-form><mml:math id="M32" altimg="si47.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> (a fixed value for all data, or automatically estimating a value for each femur), and establish how sensitive the thickness estimates are to errors in <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>1</sub></textual-form><mml:math id="M33" altimg="si48.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
        <p>For comparison, we also tested thresholding, with levels as in <xref rid="bib19" ref-type="bibr">Poole et al. (2008)</xref>, and a method similar to the 50% relative threshold of <xref rid="bib21" ref-type="bibr">Prevrhal et al. (1999)</xref>. For a fair comparison at equivalent resolutions, all methods used the same 100 sampled CT points. Additionally, our implementations of the various methods all involve fitting the model to the data in one way or another: this ensures consistent discrimination between CT peaks considered to be in the cortex and those considered to be in the trabecular bone. In general, the low resolution data exhibits just a single peak along the length of the line, but the high resolution data resolves smaller features, including intra-cortical pores, leading to multiple peaks. In such circumstances, the model-fitting algorithm implicitly determines which peaks lie within the cortex, as illustrated in <xref rid="fig3" ref-type="fig">Fig. 3</xref> for the new method and in <xref rid="fig4" ref-type="fig">Fig. 4</xref> for the comparison methods. Although they share this same methodology for cortical peak identification, the various methods otherwise differ in many respects:</p>
        <p><italic>Threshold</italic> The sampled data is first converted to binary form using the threshold: values above the threshold are set to one, those below are set to zero. Both <italic>r</italic> and <italic>σ</italic> are fixed at zero, and <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>1</sub></textual-form><mml:math id="M34" altimg="si49.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is set to one. The model-fitting process then determines which peak or peaks are considered to be cortex: <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>x</italic><sub>0</sub></textual-form><mml:math id="M35" altimg="si50.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>x</italic><sub>1</sub></textual-form><mml:math id="M36" altimg="si51.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> are exactly aligned with 0–1 transitions in the binary data, as in <xref rid="fig4" ref-type="fig">Fig. 4</xref>, and these are taken to be the cortical edges. The chosen threshold was constant over all data sets scanned in the same way with the same scanner, corresponding to approximately 430  mg/cm<sup>2</sup> areal BMD. This value is discussed further in Section <xref rid="sec6" ref-type="sec">3.1</xref>.</p>
        <p><italic>Half-max</italic><inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>1</sub></textual-form><mml:math id="M37" altimg="si52.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is set to the maximum CT value along the line. The model-fitting process then provides a robust estimate of the exterior and trabecular CT values <inline-formula><alternatives><textual-form specific-use="jats-markup">(<italic>y</italic><sub>0</sub>,<italic>y</italic><sub>2</sub>)</textual-form><mml:math id="M38" altimg="si53.gif" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and also the location of the edges <inline-formula><alternatives><textual-form specific-use="jats-markup">(<italic>x</italic><sub>0</sub>,<italic>x</italic><sub>1</sub>)</textual-form><mml:math id="M39" altimg="si54.gif" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. The <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>1</sub></textual-form><mml:math id="M40" altimg="si55.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> constraint tends to result in the edges being located on <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>blur</sub></textual-form><mml:math id="M41" altimg="si56.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext>blur</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> almost exactly half way between <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>0</sub></textual-form><mml:math id="M42" altimg="si57.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>1</sub></textual-form><mml:math id="M43" altimg="si58.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>2</sub></textual-form><mml:math id="M44" altimg="si59.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>1</sub></textual-form><mml:math id="M45" altimg="si60.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, as in <xref rid="fig4" ref-type="fig">Fig. 4</xref>. Since <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>1</sub></textual-form><mml:math id="M46" altimg="si61.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the maximum observed CT value, this is very similar to the 50% relative threshold method.</p>
        <p><italic>New fixed</italic> The new model-fitting technique with an assumed cortical CT value <inline-formula><alternatives><textual-form specific-use="jats-markup">(<italic>y</italic><sub>1</sub>)</textual-form><mml:math id="M47" altimg="si62.gif" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> fixed over all data sets scanned in the same way with the same scanner. For the experiments reported in Section <xref rid="sec5" ref-type="sec">3</xref>, a value of 1750 HU was used throughout. 1750 HU is towards the middle of the range of <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>1</sub></textual-form><mml:math id="M48" altimg="si63.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> values observed in the data (see <xref rid="tbl1" ref-type="table">Table 1</xref>).</p>
        <p><italic>New variable</italic> The new model-fitting technique with an assumed cortical CT value <inline-formula><alternatives><textual-form specific-use="jats-markup">(<italic>y</italic><sub>1</sub>)</textual-form><mml:math id="M49" altimg="si64.gif" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> chosen individually for each data set. A CT slice is selected far enough down the femur for the cortex to be sufficiently thick, such that the blurred CT peak attains the same value as the unblurred peak (i.e. as in <xref rid="fig2" ref-type="fig">Fig. 2</xref>a, but not b and c). The model is then fitted at multiple locations on this slice with both <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>1</sub></textual-form><mml:math id="M50" altimg="si65.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <italic>σ</italic> unconstrained. The average estimated <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>1</sub></textual-form><mml:math id="M51" altimg="si66.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is then used to fix the cortical CT value for that data set.</p>
        <p>There are, of course, many ways that the threshold and half-max methods could have been implemented. We chose implementations that allow a direct comparison with the new technique, and are sufficiently robust to provide independent estimates at a large number of locations on the proximal femur. While different implementations will undoubtedly vary in their nuances, they will nevertheless share the same high-level characteristics. Thresholding will sometimes miss the cortical layer entirely, and techniques similar to our half-max implementation, including the 50% relative threshold method, will estimate the PSF rather than the cortical thickness when the latter is relatively thin (<xref rid="bib17" ref-type="bibr">Newman et al., 1998</xref>).</p>
      </sec>
      <sec id="sec3">
        <label>2.3</label>
        <title>Mapping of thickness to the cortical surface</title>
        <p>So far, we have restricted our discussion to finding a cortical thickness estimate at one location in the data, given prior knowledge of both the approximate cortical surface location and orientation. However, to probe any relationship between cortical thickness and hip fracture, and to assess the various thickness estimation techniques, we would like to be able to map cortical thickness across the entire surface of the proximal femur.</p>
        <p>An approximate exterior cortical surface can be extracted from the CT data by thresholding at an appropriate value. After clicking on one seed point inside the femur, a 3D flood fill algorithm is used to label all connected CT voxels above the threshold. This results in a set of labelled pixels in each CT image, from which contours can be extracted to sub-pixel precision by making use of the threshold. Labelled regions frequently contain holes where the CT value in the trabecular bone drops below the threshold, but these are readily eliminated by discarding all contours that are circumscribed by another. This fully automatic process results in one or more contours on each slice. There are roughly 150 slices for the MDCT data sets with 1 mm slice thickness, and 50 for the 3 mm examples. For the high resolution Xtreme pQCT data, where the slice thickness is 0.082 mm, contours were extracted on every fourth slice, giving roughly 450 slices in total.</p>
        <p>After this automatic process, the contours are checked manually and edited where necessary. <xref rid="fig5" ref-type="fig">Fig. 5</xref>a and b show the two most common causes of error. The entire set of contours is then converted to a discrete 3D shape-based representation (<xref rid="bib27" ref-type="bibr">Treece et al., 2000</xref>), and an iso-surface extracted at the original contour locations (<xref rid="bib26" ref-type="bibr">Treece et al., 1999</xref>). This creates a detailed, triangulated surface of the proximal femur, with sub-pixel precision except at those locations where manual editing was necessary. The whole process takes approximately 15 min for typical low resolution data, producing a surface with typically up to 20,000 vertices. Surfaces extracted from the high resolution data are far more detailed, with over 200,000 vertices and a total processing time of about an hour. Nearly all of this time is spent manually editing the contours, the necessary amount depending strongly on the data. Contour extraction, editing, and surface creation are performed using Stradwin<xref rid="fn2" ref-type="fn">2</xref> software.</p>
        <p>The vertices are subsequently used as locations for the thickness estimates, with the corresponding surface normals defining the orientation of the cortical layer. When the cortical and CT planes are nearly parallel, <italic>a</italic> approaches 90° in Eq. <xref rid="fd6" ref-type="disp-formula">(7)</xref> and <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>t</italic><sub><italic>m</italic></sub></textual-form><mml:math id="M52" altimg="si67.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> becomes too large to measure correctly. Hence, vertices with surface normals that are approximately orthogonal to the nearest CT plane are ignored. Otherwise, the vertex and surface normal are projected back onto the nearest CT plane: one such plane is shown in <xref rid="fig5" ref-type="fig">Fig. 5</xref>c. The cyan lines show the projected vertices and normals. The red points are the cortical edges <inline-formula><alternatives><textual-form specific-use="jats-markup">(<italic>x</italic><sub>0</sub>, <italic>x</italic><sub>1</sub>)</textual-form><mml:math id="M53" altimg="si68.gif" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:mspace width="0.35em"/><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> estimated at each vertex, using lines parallel to the projected normals and positioned such that each vertex lies exactly one-third of the way along the corresponding line.</p>
        <p>It should be emphasised that the segmented surface is used only to position and orient the lines along which the thickness estimates are made, and to calculate the appropriate value of <italic>a</italic> for Eqs. <xref rid="fd8 fd6" ref-type="disp-formula">(4) and (7)</xref>. Actual cortical edges are found using the model-fitting process, and the exterior edges are generally not coincident with the projected vertices. The outcome is one thickness estimate per surface vertex. The thicknesses can be displayed collectively as a colour map painted onto the surface, as in <xref rid="fig6" ref-type="fig">Fig. 6</xref>a.</p>
      </sec>
      <sec id="sec4">
        <label>2.4</label>
        <title>Evaluation</title>
        <p>Sixteen cadaveric femurs were scanned in air using both high resolution Xtreme pQCT (82 μm/pixel, 82 μm slice thickness) and low resolution Siemens Somatom Sensation 64 MDCT (589 μm/pixel, 1 mm slice thickness). Cortical surfaces were extracted from these independently. Thickness estimates were mapped to the high resolution surface using the half-max method, since this is known to be a good, unbiased estimator, as long as the cortical thickness is sufficiently large compared with the imaging PSF (<xref rid="bib21" ref-type="bibr">Prevrhal et al., 1999</xref>), which is almost certainly the case for the Xtreme data (we shall return to this point in Section <xref rid="sec7" ref-type="sec">4</xref>). All four thickness estimation methods were used on each low resolution data set, and compared with the ‘ground truth’ high resolution measurements. To facilitate a meaningful comparison, the high resolution thickness estimates were smoothed over each surface using a filter weighted by the inverse of the residual model-fitting errors. The extent of the smoothing kernel was chosen to match the spatial resolution of the lower resolution data, as shown in <xref rid="fig6" ref-type="fig">Fig. 6</xref>b. In effect, we assume that the best we can do with the low resolution data is provide a thickness estimate that accurately represents the average thickness over the extent of the imaging PSF.</p>
        <p>To compare high and low resolution thickness maps, the two corresponding surfaces were first brought into approximate alignment by hand, using interactive visualization software that allows the pose of one surface to be varied while the other remains stationary. The co-registration was then refined using a fairly standard variant of the iterative closest point (ICP) algorithm (<xref rid="bib1" ref-type="bibr">Besl and McKay, 1992</xref>), as illustrated in <xref rid="fig7" ref-type="fig">Fig. 7</xref>. For each vertex on the low resolution surface, the closest vertex on the high resolution surface was found. Since the low and high resolution scans do not cover exactly the same areas of bone, some way of ignoring unmatched vertices is required: we chose to simply ignore any vertices on the low resolution surface that were more than 1 mm away from the closest vertex on the high resolution surface. An error metric was then defined as the sum of the squared distances from each remaining vertex on the low resolution surface to the closest vertex on the high resolution surface. This metric was minimized by adjusting the pose (six degrees of freedom, translation and rotation) and the scale of the low resolution surface. The scale parameter allows for any systematic discrepancy between the two surfaces caused by the segmentation technique.<xref rid="fn3" ref-type="fn">3</xref> Optimization was performed using the Levenberg-Marquardt method (<xref rid="bib16" ref-type="bibr">More, 1977</xref>). The ICP algorithm involves iterating this procedure, starting each iteration with a new search for the corresponding points, until the pose and scale parameters converge. For all 16 femurs, convergence was typically within 100 iterations, requiring around 15 s of computation on a 2.4 GHz Intel Core 2 Duo 6600 processor.</p>
        <p>Having registered the surfaces, low resolution thickness estimates were compared to the geographically closest estimate on the corresponding high resolution surface. Where this closest estimate was located more than 1 mm away, the two estimates were ignored, since we do not wish alignment errors to unduly influence the results. Such misalignments occur when the high resolution surface follows small, superficial features that are not resolved in the low resolution data. In practice, the 1 mm tolerance excluded only a few percent of the low resolution thickness estimates. There remained, for each femur, up to 20,000 independent estimates, with corresponding high resolution ‘ground truth’, spanning the entire range of cortical thicknesses encountered on the proximal femur. From these, we calculated the mean (accuracy) and standard deviation (precision) of the error statistic <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>t</italic><sub><italic>l</italic></sub> - <italic>t</italic><sub><italic>h</italic></sub></textual-form><mml:math id="M54" altimg="si69.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>t</italic><sub><italic>l</italic></sub></textual-form><mml:math id="M55" altimg="si70.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the low resolution thickness estimate and <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>t</italic><sub><italic>h</italic></sub></textual-form><mml:math id="M56" altimg="si71.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the corresponding high resolution estimate.</p>
        <p>The upper graph in <xref rid="fig8" ref-type="fig">Fig. 8</xref> shows the average distribution of cortical thickness over the 16 proximal femurs, which is well populated in the 0.25–6 mm range. Since we are more interested in thinner cortical regions, we use 0–4 mm colour maps for surface renderings such as those in <xref rid="fig6" ref-type="fig">Fig. 6</xref>. The error distribution for the ‘new variable’ thickness estimation technique is shown in the lower graph of <xref rid="fig8" ref-type="fig">Fig. 8</xref>. While there is a narrow peak, outlying errors extend up to ±15 mm.</p>
        <p>Many of these outliers can be attributed to the evaluation protocol as opposed to the thickness estimation technique. <xref rid="fig9" ref-type="fig">Fig. 9</xref> shows two situations where the protocol leads to inappropriate comparisons between thickness estimates. <xref rid="fig9" ref-type="fig">Fig. 9</xref>d, in particular, demonstrates the difficulty in defining cortical thickness at two different resolutions when the cortex is porous. To eliminate such inappropriate comparisons from our results, we chose a threshold of 4 mm, above which we assume the error is more likely to be an artefact of the evaluation protocol than the thickness estimation technique. Clearly, this threshold might also remove genuine estimation errors, although <xref rid="fig8" ref-type="fig">Fig. 8</xref>b shows that these will be very few in number. It is also unlikely that an error exceeding 4 mm would be mistaken for a correct measurement in practice. Nevertheless, in Section <xref rid="sec5" ref-type="sec">3</xref> we present error statistics both with and without the 4 mm cut-off, so the reader can judge for themselves.</p>
      </sec>
      <sec>
        <label>2.5</label>
        <title>In vivo protocol</title>
        <p>The new technique was also applied to two in vivo examinations of consented study participants. A 39-year old female was examined in a Siemens SOMATOM Sensation 64 machine (Siemens AG, Erlangen, Germany) and an 87-year old male with a recent femoral neck fracture was examined in a GE 64 Lightspeed PET/CT machine (GE Medical Systems, Waukesha, Wisconsin, USA). Proximal femurs were scanned from 2 cm proximal to the superior acetabular margin to 2 cm below the lesser trochanters. The study was approved by the Cambridgeshire Regional Ethics Committee and subjects were recruited according to the Declaration of Helsinki.</p>
      </sec>
    </sec>
    <sec id="sec5">
      <label>3</label>
      <title>Results</title>
      <sec id="sec6">
        <label>3.1</label>
        <title>Simulated data</title>
        <p>The thickness estimation methods described in Section <xref rid="sec2" ref-type="sec">2.2</xref> were first tested on simulated data, in order to investigate performance and parameter sensitivity in an ideal, noise-free environment. The model of Eq. <xref rid="fd1" ref-type="disp-formula">(5)</xref> was used to simulate the CT values along lines passing through cortices of varying thickness in the range 0.2 mm to 5.5 mm, with an in-plane blur <italic>σ</italic> of 1.25 mm and no out-of-plane blur (i.e. the cortical layer was assumed to lie orthogonal to the CT imaging plane). These values were chosen to match approximately those of the low resolution cadaveric data sets. The half-max, threshold and new methods were then used to estimate the original, known, cortical thickness. The latter two methods were evaluated across a range of thresholds and assumed cortical CT values <inline-formula><alternatives><textual-form specific-use="jats-markup">(<italic>y</italic><sub>1</sub>)</textual-form><mml:math id="M57" altimg="si72.gif" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
        <p><xref rid="fig10" ref-type="fig">Fig. 10</xref> shows results for simulated scans in air (a) and in vivo (b). As reported by <xref rid="bib17" ref-type="bibr">Newman et al. (1998)</xref>, the half-max method is accurate for large thicknesses but increasingly biased for smaller thicknesses. The thresholding technique is potentially more accurate below 3 mm, provided the threshold is chosen carefully. For the air simulation, a threshold of 600 HU (for the low resolution data, this corresponds to an areal BMD of approximately 430 mg/cm<sup>2</sup>) produces reasonable estimates of thickness above 1.3 mm. For the in vivo simulation, the ideal threshold is higher, at around 800 HU. Below 1.3 mm, thresholding starts to ‘miss’ the cortex and becomes increasingly unreliable, as previously noted by <xref rid="bib19" ref-type="bibr">Poole et al. (2008)</xref>. The new method generates accurate results down to the simulated thickness limit of 0.2 mm. This in itself is not surprising: we have, after all, used exactly the same model to simulate as to estimate thickness. More noteworthy is the low degree of sensitivity to the assumed cortical CT value, especially at thicknesses below 2 mm. Such thin cortices are precisely those likely to be of most clinical interest.</p>
      </sec>
      <sec>
        <label>3.2</label>
        <title>Cadaveric data</title>
        <p>Summary statistics for the 16 cadaveric data sets can be found in <xref rid="tbl1" ref-type="table">Table 1</xref>. For the half-max and new methods, the percentage success rate indicates how frequently the model-fitting algorithm managed to converge and hence produce a result. For the threshold method, the number indicates how frequently there were <italic>any</italic> CT values above the threshold along the line used for thickness estimation. Neither convergence nor the existence of supra-threshold values implies anything about the accuracy of the resulting thickness estimate. The processing time was similar for all methods. Loading the CT data, estimating cortical thickness at approximately 17,000 locations and saving the results to disk (but not calculating or registering the surfaces) took around 5 min on a 2.16 GHz Intel Core2 CPU, with the software running single-threaded.</p>
        <p><xref rid="tbl2" ref-type="table">Table 2</xref> shows estimation accuracy and precision for the entire range of errors, i.e. not making any allowance for likely evaluation artefacts like those in <xref rid="fig9" ref-type="fig">Fig. 9</xref>. While it is immediately apparent that both variants of the new method are less biased and more precise than either of the alternative methods, we must at this point take a brief diversion, to test the claim in Section <xref rid="sec2" ref-type="sec">2.2</xref> that constraining <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>1</sub></textual-form><mml:math id="M58" altimg="si73.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the best strategy for conditioning the model-fitting process. To this end, we performed some supplementary experiments on femur 477, chosen since it is an average specimen in terms of the estimation errors in <xref rid="tbl2" ref-type="table">Table 2</xref>. In Section <xref rid="sec2" ref-type="sec">2.2</xref>, we considered three possibilities: constraining the assumed cortical CT value <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>1</sub></textual-form><mml:math id="M59" altimg="si74.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>; constraining the in-plane blur <italic>σ</italic>; or using no constraints at all. With femur 477, no constraints resulted in an estimation error of <inline-formula><alternatives><textual-form specific-use="jats-markup">0.90±4.04  mm</textual-form><mml:math id="M60" altimg="si75.gif" overflow="scroll"><mml:mrow><mml:mn>0.90</mml:mn><mml:mo>±</mml:mo><mml:mn>4.04</mml:mn><mml:mspace width="0.25em"/><mml:mspace width="0.35em" height="0.8ex"/><mml:mtext>mm</mml:mtext></mml:mrow></mml:math></alternatives></inline-formula>, constraining <italic>σ</italic> (to a sensible median value obtained from the previous experiment) but not <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>1</sub></textual-form><mml:math id="M61" altimg="si76.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> gave an error of <inline-formula><alternatives><textual-form specific-use="jats-markup">0.66±3.75 mm</textual-form><mml:math id="M62" altimg="si77.gif" overflow="scroll"><mml:mrow><mml:mn>0.66</mml:mn><mml:mo>±</mml:mo><mml:mn>3.75</mml:mn><mml:mspace width="0.25em"/><mml:mtext>mm</mml:mtext></mml:mrow></mml:math></alternatives></inline-formula>, whereas fixing <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>1</sub></textual-form><mml:math id="M63" altimg="si78.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> at 1750 HU produced by far the best results of <inline-formula><alternatives><textual-form specific-use="jats-markup">0.00±0.72 mm</textual-form><mml:math id="M64" altimg="si79.gif" overflow="scroll"><mml:mrow><mml:mn>0.00</mml:mn><mml:mo>±</mml:mo><mml:mn>0.72</mml:mn><mml:mspace width="0.25em"/><mml:mtext>mm</mml:mtext></mml:mrow></mml:math></alternatives></inline-formula>. This is typical of our experience with all the data sets we have examined. There was very little difference in the percentage success rates for each of these variants of the new technique.</p>
        <p><xref rid="tbl3" ref-type="table">Table 3</xref> presents the results after accounting for likely evaluation artefacts using the ±4 mm error cut-off suggested in Section <xref rid="sec4" ref-type="sec">2.4</xref>. The order of merit of the various methods is the same as in <xref rid="tbl2" ref-type="table">Table 2</xref>, though clearly all the standard deviations are reduced. These results may better reflect the actual measurement error across the entire surface of the proximal femur. Finally, <xref rid="tbl4" ref-type="table">Table 4</xref> presents results confined to areas where the cortex is relatively thin, in the range 0.3–2 mm. Such areas are likely to be the focus of interest when assessing fracture risk. For thin cortices, the differences between the methods are even more pronounced.</p>
        <p>Finally, the results are presented as a function of location on the proximal femur, for the best and worst cases in <xref rid="fig12 fig13" ref-type="fig">Figs. 12 and 13</xref> respectively. These images are stills from a user interface which displays the cortical thickness as a colour map, as described in Section <xref rid="sec3" ref-type="sec">2.3</xref>. The surface can be examined from any viewpoint. The light grey colour, mostly evident for the threshold method in the second column, indicates regions in which no estimate is available. Away from these regions, the threshold method produces thickness maps that appear similar to the high resolution ‘ground truth’ in the first column. The half-max method (third column) generates few thickness estimates below 2 mm (green). The ‘new variable’ method (fourth column) produces thickness maps that are similar to the high resolution maps, with absolute errors generally less than 0.5 mm (pink in the error maps).</p>
      </sec>
      <sec>
        <label>3.3</label>
        <title>In vivo data</title>
        <p>The various methods for cortical thickness estimation were assessed using cadaveric femurs scanned in air, since the human proximal femur cannot be imaged in vivo at the high resolutions required to establish the ‘ground truth’. In clinical CT scans, the femur is of course surrounded mostly by soft tissue, not air. While the new thickness estimation technique makes no assumption about the surrounding material, except that it is reasonably uniform,<xref rid="fn4" ref-type="fn">4</xref> it is nevertheless reasonable to question how performance might vary between cadaveric and in vivo examples.</p>
        <p><xref rid="fig11" ref-type="fig">Fig. 11</xref> expands the results in <xref rid="tbl3" ref-type="table">Table 3</xref> to show performance as a function of true cortical thickness. Since the techniques produce so many independent thickness estimates in the range 0.3–4 mm (<xref rid="fig8" ref-type="fig">Fig. 8</xref>a), splitting the data for any one femur into bins 0.1 mm wide produces over 100 values per bin, and well over 1000 values when the data for all femurs is combined. This is sufficient to analyse performance as a function of thickness in the aforementioned range. The conglomerated results in <xref rid="fig11" ref-type="fig">Fig. 11</xref>c have more in common with the results for the best case (femur 473, <xref rid="fig11" ref-type="fig">Fig. 11</xref>a) than those for the worst case (femur 467, <xref rid="fig11" ref-type="fig">Fig. 11</xref>b), suggesting that the latter is the exception.</p>
        <p><xref rid="fig11" ref-type="fig">Fig. 11</xref> also shows percentage success rates as a function of thickness. The threshold method starts to ‘miss’ estimates as the true cortical thickness drops below 1.5 mm, and is largely incapable of producing any reliable results below 0.75 mm. For the carefully chosen threshold, the estimates are reasonably unbiased down to 1 mm. The half-max and ‘new variable’ methods both generate cortical thickness estimates over the full 0.3–4 mm range. However, the half-max method overestimates the thickness below 3 mm, whereas the new method provides relatively unbiased estimates at all thicknesses. In general, the new method also compares favourably with the others in terms of precision, again across the entire range of thicknesses.</p>
        <p><xref rid="fig14" ref-type="fig">Fig. 14</xref> shows cortical thickness maps produced using the ‘new variable’ method, working with in vivo MDCT data at 1.25 mm slice thickness. There is no ground truth for this data, and it is just a single example, so it cannot be used to draw any firm conclusions. However, there is reasonably good agreement between the independent maps on the fractured and contralateral hip; the new method produces estimates across most of the proximal femur; and the maps are not dissimilar to those in <xref rid="fig12 fig13" ref-type="fig">Figs. 12 and 13</xref>. The feasibility of applying this technique to fractured hips in vivo has potential clinical significance. Compared with intact femurs, the surface extraction stage was less straightforward (more manual editing was required), but the thickness estimation stage was no different, since all measurements are mutually independent.</p>
        <p>Clinical data is, of course, typically acquired at slice thicknesses exceeding 1 mm. <xref rid="fig15" ref-type="fig">Fig. 15</xref> shows cortical thickness maps estimated using the ‘new variable’ method, starting from the same in vivo scan but with different CT reconstructions at 1 mm and 3 mm slice thickness. Again, we can draw no firm conclusions from a single example, but the 0.01 ± 0.30 mm discrepancy between the two maps is remarkably low. This gives reasonable grounds for optimism regarding the applicability of the method to 3 mm slice CT data.</p>
        <p>The light grey regions in <xref rid="fig14 fig15" ref-type="fig">Figs. 14 and 15</xref> indicate areas where the new method failed to produce a thickness estimate. This was due to the close proximity of the acetabulum to the femoral head, preventing the successful estimation of <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>0</sub></textual-form><mml:math id="M65" altimg="si81.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. The cadaveric maps are free of such regions because, although the femurs were supported by a pelvis phantom, the acetabulum was not as close to the femoral head.</p>
      </sec>
    </sec>
    <sec id="sec7">
      <label>4</label>
      <title>Discussion</title>
      <p>In general, the various thickness estimation techniques were observed to perform in accordance with the assumed model. However, close inspection of the graphs in <xref rid="fig11" ref-type="fig">Fig. 11</xref>c reveals two clear differences from the simulations in <xref rid="fig10" ref-type="fig">Fig. 10</xref>. While the half-max estimates do, as predicted, attain a plateau of around 2.5 mm (consistent with an estimated in-plane blur of <inline-formula><alternatives><textual-form specific-use="jats-markup">σ = 1.25  mm</textual-form><mml:math id="M66" altimg="si82.gif" overflow="scroll"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.25</mml:mn><mml:mspace width="0.25em"/><mml:mspace width="0.35em" height="0.8ex"/><mml:mtext>mm</mml:mtext></mml:mrow></mml:math></alternatives></inline-formula>), at true cortical thicknesses below 1 mm they drop below this plateau, in a manner not explained by the model. Similarly, the threshold estimates inexplicably show a sharp increase at low cortical thicknesses. To understand these phenomena, we must first rule out any systematic inaccuracies in the ‘ground truth’ thicknesses. Recall, these were obtained by applying the half-max method to the Xtreme pQCT data, which is approximately seven times higher resolution than the Siemens MDCT data. <xref rid="fig11" ref-type="fig">Fig. 11</xref>c shows the half-max method starting to produce biased thickness estimates below 3 mm, this being with the low resolution data. It follows, therefore, that we should not trust our ‘ground truth’ much below <inline-formula><alternatives><textual-form specific-use="jats-markup">3 / 7 = 0.43  mm</textual-form><mml:math id="M67" altimg="si83.gif" overflow="scroll"><mml:mrow><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mn>7</mml:mn><mml:mo>=</mml:mo><mml:mn>0.43</mml:mn><mml:mspace width="0.25em"/><mml:mspace width="0.35em" height="0.8ex"/><mml:mtext>mm</mml:mtext></mml:mrow></mml:math></alternatives></inline-formula>. This is sufficiently close to the lower limit of 0.3 mm in <xref rid="fig11" ref-type="fig">Fig. 11</xref>c that it is unlikely to have a significant bearing on the results.</p>
      <p>Instead, explanations for these two phenomena become apparent on close examination of the data where the cortex is very thin. For the half-max method, the cortical CT value <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>1</sub></textual-form><mml:math id="M68" altimg="si84.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> becomes poorly defined and is often very similar to the trabecular value <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>2</sub></textual-form><mml:math id="M69" altimg="si85.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. Consequently, the inner cortical edge <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>x</italic><sub>1</sub></textual-form><mml:math id="M70" altimg="si86.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> can be positioned almost arbitrarily, resulting in spurious thickness estimates that do not necessarily reflect the width of the imaging PSF. The strange behaviour of the threshold graph is driven by a relatively small number of thickness estimates: in the vast majority of cases, the imaged cortex does not exceed the threshold and the threshold method fails. However, occasionally the trabecular bone, at the <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>2</sub></textual-form><mml:math id="M71" altimg="si87.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> end of the estimation line, has sufficiently high density to exceed the threshold. Thresholding then does produce a thickness estimate, but not one of the thin cortex, rather one of a thicker region of trabecular bone. This is why the threshold graph in <xref rid="fig11" ref-type="fig">Fig. 11</xref>c turns upwards.</p>
      <p>The thickness maps in <xref rid="fig12 fig13" ref-type="fig">Figs. 12 and 13</xref> show that the errors are not homogeneously distributed across the surface. Instead, they are clustered at small focal patches. We observed similar behaviour in all 16 data sets. The most likely cause of such errors is an ambiguous cortical-trabecular interface in these regions, suggesting different interpretations in the low and high resolution data. Certainly, the ‘worst’ data set (467) has a particularly dense matrix structure in the trabecular bone. The image in <xref rid="fig9" ref-type="fig">Fig. 9</xref> is from this data set: at certain locations, such as around line 2, it is not at all clear where the cortex ends and the trabecular bone begins. While we attempted to eliminate such artefacts from our results by ignoring outlying errors, cortical ambiguity will not always result in a discrepancy exceeding the 4 mm cut-off, and the variances in <xref rid="tbl3" ref-type="table">Table 3</xref> might therefore be seen as upper limits on the true estimation errors. Where the cortex is well defined, estimation errors are likely to be well within these bounds: witness the pink regions in the surface error maps (<xref rid="fig12 fig13" ref-type="fig">Figs. 12 and 13</xref>, (g) and (n)), where the error is everywhere less than 0.5 mm.</p>
    </sec>
    <sec id="sec8">
      <label>5</label>
      <title>Conclusions</title>
      <p>We have presented a novel method for estimating cortical thickness from clinical CT data. In a series of cadaveric experiments using standard MDCT (589 μm/pixel resolution, in-plane blur well approximated by a Gaussian PSF of standard deviation 1.25 mm), the method was able to produce unbiased estimates down to 0.3 mm. Errors were observed to be −0.01 ± 0.58 mm over the full range of thicknesses, and 0.01 ± 0.47 mm for thin cortices in the range 0.3–2 mm. This is a clear improvement over the alternative thresholding and 50% relative threshold techniques, which are particularly poor when the cortex is thin. Thin cortices are precisely those likely to be of most clinical interest.</p>
      <p>The new method is highly automated and typically produces 17,000 independent thickness estimates over the surface of the proximal femur. These can be displayed as a colour map painted onto the surface, and visualized from any angle. Workflow is already in the realms of clinical practicality: around 10 min to segment the surface, then around 5 min to calculate the thicknesses, using just a modest laptop computer. Faster segmentation might be possible with the use of anatomically specific tools.</p>
      <p>Future work will seek to further validate the new technique in vivo, using CT slice thicknesses of 3 mm and above, though <xref rid="fig14 fig15" ref-type="fig">Figs. 14 and 15</xref> give grounds for optimism. In the longer term, it is anticipated that cortical thickness maps, like the ones in <xref rid="fig12 fig13 fig14 fig15" ref-type="fig">Figs. 12–15</xref>, will become a useful tool for both medical research and clinical practice. With inter-subject co-registration, statistical atlases could be constructed showing cortical thickness over the proximal femur for different groups: e.g. young vs. old, trochanteric vs. femoral neck fractures, cases vs. controls. By comparing such atlases, regions of interest might emerge to serve as biomarkers indicative of fracture risk. Cortical thickness maps might also inform longitudinal studies of patients undergoing anabolic therapy, by determining precisely where any thickening occurs. Finally, cortical thickness would be an important component of patient-specific models that might, one day, emerge as the clinical gold standard for assessing the mechanical competence of individual femurs.</p>
    </sec>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="bib1">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Besl</surname>
              <given-names>P.J.</given-names>
            </name>
            <name>
              <surname>McKay</surname>
              <given-names>N.D.</given-names>
            </name>
          </person-group>
          <article-title>A method for registration of 3-D shapes</article-title>
          <source>IEEE Trans. Pattern Anal. Mach. Intell.</source>
          <volume>14</volume>
          <issue>2</issue>
          <year>1992</year>
          <fpage>239</fpage>
          <lpage>256</lpage>
        </element-citation>
      </ref>
      <ref id="bib2">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Bouxsein</surname>
              <given-names>M.L.</given-names>
            </name>
            <name>
              <surname>Delmas</surname>
              <given-names>P.D.</given-names>
            </name>
          </person-group>
          <article-title>Considerations for development of surrogate endpoints for antifracture efficacy of new treatments in osteoporosis: a perspective</article-title>
          <source>J. Bone Miner. Res.</source>
          <volume>23</volume>
          <issue>8</issue>
          <year>2008</year>
          <fpage>1155</fpage>
          <lpage>1167</lpage>
          <pub-id pub-id-type="pmid">18318643</pub-id>
        </element-citation>
      </ref>
      <ref id="bib3">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Buie</surname>
              <given-names>H.R.</given-names>
            </name>
            <name>
              <surname>Campbell</surname>
              <given-names>G.M.</given-names>
            </name>
            <name>
              <surname>Klinck</surname>
              <given-names>R.J.</given-names>
            </name>
            <name>
              <surname>MacNeil</surname>
              <given-names>J.A.</given-names>
            </name>
            <name>
              <surname>Boyd</surname>
              <given-names>S.K.</given-names>
            </name>
          </person-group>
          <article-title>Automatic segmentation of cortical and trabecular compartments based on a dual threshold technique for in vivo micro-CT bone analysis</article-title>
          <source>Bone</source>
          <volume>41</volume>
          <issue>4</issue>
          <year>2007</year>
          <fpage>505</fpage>
          <lpage>515</lpage>
          <pub-id pub-id-type="pmid">17693147</pub-id>
        </element-citation>
      </ref>
      <ref id="bib4">
        <element-citation publication-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Burger</surname>
              <given-names>W.</given-names>
            </name>
            <name>
              <surname>Burge</surname>
              <given-names>M.J.</given-names>
            </name>
          </person-group>
          <chapter-title>Principles of Digital Image Processing: Core Algorithms</chapter-title>
          <year>2009</year>
          <publisher-name>Springer-Verlag</publisher-name>
        </element-citation>
      </ref>
      <ref id="bib5">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Carpenter</surname>
              <given-names>R.D.</given-names>
            </name>
            <name>
              <surname>Beaupre</surname>
              <given-names>G.S.</given-names>
            </name>
            <name>
              <surname>Lang</surname>
              <given-names>T.F.</given-names>
            </name>
            <name>
              <surname>Orwoll</surname>
              <given-names>E.S.</given-names>
            </name>
            <name>
              <surname>Carter</surname>
              <given-names>D.R.</given-names>
            </name>
          </person-group>
          <article-title>New QCT analysis approach shows the importance of fall orientation on femoral neck strength</article-title>
          <source>J. Bone Miner. Res.</source>
          <volume>20</volume>
          <issue>9</issue>
          <year>2005</year>
          <fpage>1533</fpage>
          <lpage>1542</lpage>
          <pub-id pub-id-type="pmid">16059625</pub-id>
        </element-citation>
      </ref>
      <ref id="bib6">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>de Bakker</surname>
              <given-names>P.M.</given-names>
            </name>
            <name>
              <surname>Manske</surname>
              <given-names>S.L.</given-names>
            </name>
            <name>
              <surname>Ebacher</surname>
              <given-names>V.</given-names>
            </name>
            <name>
              <surname>Oxland</surname>
              <given-names>T.R.</given-names>
            </name>
            <name>
              <surname>Cripton</surname>
              <given-names>P.A.</given-names>
            </name>
            <name>
              <surname>Guy</surname>
              <given-names>P.</given-names>
            </name>
          </person-group>
          <article-title>During sideways falls proximal femur fractures initiate in the superolateral cortex: evidence from high-speed video of simulated fractures</article-title>
          <source>J. Biomech.</source>
          <volume>42</volume>
          <issue>12</issue>
          <year>2009</year>
          <fpage>1917</fpage>
          <lpage>1925</lpage>
          <pub-id pub-id-type="pmid">19524929</pub-id>
        </element-citation>
      </ref>
      <ref id="bib7">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Dougherty</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>Newman</surname>
              <given-names>D.</given-names>
            </name>
          </person-group>
          <article-title>Measurement of thickness and density of thin structures by computed tomography</article-title>
          <source>Med. Phys.</source>
          <volume>26</volume>
          <issue>7</issue>
          <year>1999</year>
          <fpage>1341</fpage>
          <lpage>1348</lpage>
          <pub-id pub-id-type="pmid">10435536</pub-id>
        </element-citation>
      </ref>
      <ref id="bib8">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Hangartner</surname>
              <given-names>T.N.</given-names>
            </name>
          </person-group>
          <article-title>Thresholding technique for accurate analysis of density and geometry in QCT, PQCT and μCT images</article-title>
          <source>J. Musculoskelet. Neuronal. Interact.</source>
          <volume>7</volume>
          <issue>1</issue>
          <year>2007</year>
          <fpage>9</fpage>
          <lpage>16</lpage>
          <pub-id pub-id-type="pmid">17396001</pub-id>
        </element-citation>
      </ref>
      <ref id="bib9">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Hangartner</surname>
              <given-names>T.N.</given-names>
            </name>
            <name>
              <surname>Gilsanz</surname>
              <given-names>V.</given-names>
            </name>
          </person-group>
          <article-title>Evaluation of cortical bone by computed tomography</article-title>
          <source>J. Bone Miner. Res.</source>
          <volume>11</volume>
          <issue>10</issue>
          <year>1996</year>
          <fpage>1518</fpage>
          <lpage>1525</lpage>
          <pub-id pub-id-type="pmid">8889852</pub-id>
        </element-citation>
      </ref>
      <ref id="bib10">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Holzer</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>von Skrbensky</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>Holzer</surname>
              <given-names>L.A.</given-names>
            </name>
            <name>
              <surname>Pichl</surname>
              <given-names>W.</given-names>
            </name>
          </person-group>
          <article-title>Hip fractures and the contribution of cortical versus trabecular bone to femoral neck strength</article-title>
          <source>J. Bone Miner. Res.</source>
          <volume>24</volume>
          <issue>3</issue>
          <year>2009</year>
          <fpage>468</fpage>
          <lpage>474</lpage>
          <pub-id pub-id-type="pmid">19016592</pub-id>
        </element-citation>
      </ref>
      <ref id="bib11">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Johnell</surname>
              <given-names>O.</given-names>
            </name>
            <name>
              <surname>Kanis</surname>
              <given-names>J.A.</given-names>
            </name>
            <name>
              <surname>Oden</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Johansson</surname>
              <given-names>H.</given-names>
            </name>
            <name>
              <surname>Laet</surname>
              <given-names>C.D.</given-names>
            </name>
            <name>
              <surname>Delmas</surname>
              <given-names>P.</given-names>
            </name>
            <name>
              <surname>Eisman</surname>
              <given-names>J.A.</given-names>
            </name>
            <name>
              <surname>Fujiwara</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Kroger</surname>
              <given-names>H.</given-names>
            </name>
            <name>
              <surname>Mellstrom</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Meunier</surname>
              <given-names>P.J.</given-names>
            </name>
            <name>
              <surname>Melton</surname>
              <given-names>L.J.</given-names>
              <suffix>3rd</suffix>
            </name>
            <name>
              <surname>O’Neill</surname>
              <given-names>T.</given-names>
            </name>
            <name>
              <surname>Pols</surname>
              <given-names>H.</given-names>
            </name>
            <name>
              <surname>Reeve</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Silman</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Tenenhouse</surname>
              <given-names>A.</given-names>
            </name>
          </person-group>
          <article-title>Predictive value of bmd for hip and other fractures</article-title>
          <source>J. Bone Miner. Res.</source>
          <volume>20</volume>
          <issue>7</issue>
          <year>2005</year>
          <fpage>1185</fpage>
          <lpage>1194</lpage>
          <pub-id pub-id-type="pmid">15940371</pub-id>
        </element-citation>
      </ref>
      <ref id="bib12">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Kanis</surname>
              <given-names>J.A.</given-names>
            </name>
            <name>
              <surname>Burlet</surname>
              <given-names>N.</given-names>
            </name>
            <name>
              <surname>Cooper</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Delmas</surname>
              <given-names>P.D.</given-names>
            </name>
            <name>
              <surname>Reginster</surname>
              <given-names>J.Y.</given-names>
            </name>
            <name>
              <surname>Borgstrom</surname>
              <given-names>F.</given-names>
            </name>
            <name>
              <surname>Rizzoli</surname>
              <given-names>R.</given-names>
            </name>
          </person-group>
          <article-title>European guidance for the diagnosis and management of osteoporosis in postmenopausal women</article-title>
          <source>Osteoporos. Int.</source>
          <volume>19</volume>
          <issue>4</issue>
          <year>2008</year>
          <fpage>399</fpage>
          <lpage>428</lpage>
          <pub-id pub-id-type="pmid">18266020</pub-id>
        </element-citation>
      </ref>
      <ref id="bib13">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Kaptoge</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Beck</surname>
              <given-names>T.J.</given-names>
            </name>
            <name>
              <surname>Reeve</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Stone</surname>
              <given-names>K.L.</given-names>
            </name>
            <name>
              <surname>Hillier</surname>
              <given-names>T.A.</given-names>
            </name>
            <name>
              <surname>Cauley</surname>
              <given-names>J.A.</given-names>
            </name>
            <name>
              <surname>Cummings</surname>
              <given-names>S.R.</given-names>
            </name>
          </person-group>
          <article-title>Prediction of incident hip fracture risk by femur geometry variables measured by hip structural analysis in the study of osteoporotic fractures</article-title>
          <source>J. Bone Miner. Res.</source>
          <volume>23</volume>
          <issue>12</issue>
          <year>2008</year>
          <fpage>1892</fpage>
          <lpage>1904</lpage>
          <pub-id pub-id-type="pmid">18684092</pub-id>
        </element-citation>
      </ref>
      <ref id="bib14">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Keaveny</surname>
              <given-names>T.M.</given-names>
            </name>
            <name>
              <surname>Hoffmann</surname>
              <given-names>P.F.</given-names>
            </name>
            <name>
              <surname>Singh</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Palermo</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Bilezikian</surname>
              <given-names>J.P.</given-names>
            </name>
            <name>
              <surname>Greenspan</surname>
              <given-names>S.L.</given-names>
            </name>
            <name>
              <surname>Black</surname>
              <given-names>D.M.</given-names>
            </name>
          </person-group>
          <article-title>Femoral bone strength and its relation to cortical and trabecular changes after treatment with pth, alendronate, and their combination as assessed by finite element analysis of quantitative CT scans</article-title>
          <source>J. Bone Miner. Res.</source>
          <volume>23</volume>
          <issue>12</issue>
          <year>2008</year>
          <fpage>1974</fpage>
          <lpage>1982</lpage>
          <pub-id pub-id-type="pmid">18684084</pub-id>
        </element-citation>
      </ref>
      <ref id="bib15">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Mayhew</surname>
              <given-names>P.M.</given-names>
            </name>
            <name>
              <surname>Thomas</surname>
              <given-names>C.D.</given-names>
            </name>
            <name>
              <surname>Clement</surname>
              <given-names>J.G.</given-names>
            </name>
            <name>
              <surname>Loveridge</surname>
              <given-names>N.</given-names>
            </name>
            <name>
              <surname>Beck</surname>
              <given-names>T.J.</given-names>
            </name>
            <name>
              <surname>Bonfield</surname>
              <given-names>W.</given-names>
            </name>
            <name>
              <surname>Burgoyne</surname>
              <given-names>C.J.</given-names>
            </name>
            <name>
              <surname>Reeve</surname>
              <given-names>J.</given-names>
            </name>
          </person-group>
          <article-title>Relation between age, femoral neck cortical stability, and hip fracture risk</article-title>
          <source>Lancet</source>
          <volume>366</volume>
          <issue>9480</issue>
          <year>2005</year>
          <fpage>129</fpage>
          <lpage>135</lpage>
          <pub-id pub-id-type="pmid">16005335</pub-id>
        </element-citation>
      </ref>
      <ref id="bib16">
        <element-citation publication-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>More</surname>
              <given-names>J.J.</given-names>
            </name>
          </person-group>
          <chapter-title>The Levenberg-Marquardt algorithm: implementation and theory</chapter-title>
          <person-group person-group-type="editor">
            <name>
              <surname>Watson</surname>
              <given-names>A.</given-names>
            </name>
          </person-group>
          <series>Numerical Analysis. Lecture Notes in Mathematics</series>
          <volume>vol. 630</volume>
          <year>1977</year>
          <publisher-name>Springer-Verlag</publisher-name>
          <fpage>105</fpage>
          <lpage>116</lpage>
        </element-citation>
      </ref>
      <ref id="bib17">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Newman</surname>
              <given-names>D.L.</given-names>
            </name>
            <name>
              <surname>Dougherty</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>Obaid</surname>
              <given-names>A.A.</given-names>
            </name>
            <name>
              <surname>Hajrasy</surname>
              <given-names>H.A.</given-names>
            </name>
          </person-group>
          <article-title>Limitations of clinical CT in assessing cortical thickness and density</article-title>
          <source>Phys. Med. Biol.</source>
          <volume>43</volume>
          <issue>3</issue>
          <year>1998</year>
          <fpage>619</fpage>
          <lpage>626</lpage>
          <pub-id pub-id-type="pmid">9533140</pub-id>
        </element-citation>
      </ref>
      <ref id="bib18">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Parker</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Johansen</surname>
              <given-names>A.</given-names>
            </name>
          </person-group>
          <article-title>Hip fracture</article-title>
          <source>BMJ</source>
          <volume>333</volume>
          <issue>7557</issue>
          <year>2006</year>
          <fpage>27</fpage>
          <lpage>30</lpage>
          <pub-id pub-id-type="pmid">16809710</pub-id>
        </element-citation>
      </ref>
      <ref id="bib19">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Poole</surname>
              <given-names>K.E.S.</given-names>
            </name>
            <name>
              <surname>Rose</surname>
              <given-names>C.M.</given-names>
            </name>
            <name>
              <surname>Mayhew</surname>
              <given-names>P.M.</given-names>
            </name>
            <name>
              <surname>Brown</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Clement</surname>
              <given-names>J.G.</given-names>
            </name>
            <name>
              <surname>Thomas</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Reeve</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Loveridge</surname>
              <given-names>N.</given-names>
            </name>
          </person-group>
          <article-title>Thresholds for the measurement of cortical thickness in-vivo using computed tomography (the 100 women study)</article-title>
          <source>Calcif. Tissue Int.</source>
          <volume>83</volume>
          <issue>1</issue>
          <year>2008</year>
          <fpage>33</fpage>
        </element-citation>
      </ref>
      <ref id="bib20">
        <mixed-citation publication-type="other">Poole, K.E.S., Mayhew, P.M., Rose, C.M., Brown, J.K., Bearcroft, P.J., Loveridge, N., Reeve, J., 2009. Changing structure of the femoral neck across the adult female lifespan. J. Bone Miner. Res. 1–35. <ext-link ext-link-type="doi" xlink:href="10.1359/jbmr.090734">doi:10.1359/jbmr.090734</ext-link>. Available online 18 December 2009.</mixed-citation>
      </ref>
      <ref id="bib21">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Prevrhal</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Engelke</surname>
              <given-names>K.</given-names>
            </name>
            <name>
              <surname>Kalander</surname>
              <given-names>W.A.</given-names>
            </name>
          </person-group>
          <article-title>Accuracy limits for the determination of cortical width and density: the influence of object size and CT imaging parameters</article-title>
          <source>Phys. Med. Biol.</source>
          <volume>44</volume>
          <issue>3</issue>
          <year>1999</year>
          <fpage>751</fpage>
          <lpage>764</lpage>
          <pub-id pub-id-type="pmid">10211808</pub-id>
        </element-citation>
      </ref>
      <ref id="bib22">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Prevrhal</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Fox</surname>
              <given-names>J.C.</given-names>
            </name>
            <name>
              <surname>Shepherd</surname>
              <given-names>J.A.</given-names>
            </name>
            <name>
              <surname>Genant</surname>
              <given-names>H.K.</given-names>
            </name>
          </person-group>
          <article-title>Accuracy of CT-based thickness measurement of thin structures: Modeling of limited spatial resolution in all three dimensions</article-title>
          <source>Med. Phys.</source>
          <volume>30</volume>
          <issue>1</issue>
          <year>2003</year>
          <fpage>1</fpage>
          <lpage>8</lpage>
          <pub-id pub-id-type="pmid">12557971</pub-id>
        </element-citation>
      </ref>
      <ref id="bib23">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Sambrook</surname>
              <given-names>P.</given-names>
            </name>
            <name>
              <surname>Cooper</surname>
              <given-names>C.</given-names>
            </name>
          </person-group>
          <source>Osteoporosis Lancet</source>
          <volume>367</volume>
          <issue>9527</issue>
          <year>2006</year>
          <fpage>2010</fpage>
          <lpage>2018</lpage>
        </element-citation>
      </ref>
      <ref id="bib24">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Sanders</surname>
              <given-names>K.M.</given-names>
            </name>
            <name>
              <surname>Nicholson</surname>
              <given-names>G.C.</given-names>
            </name>
            <name>
              <surname>Watts</surname>
              <given-names>J.J.</given-names>
            </name>
            <name>
              <surname>Pasco</surname>
              <given-names>J.A.</given-names>
            </name>
            <name>
              <surname>Henry</surname>
              <given-names>M.J.</given-names>
            </name>
            <name>
              <surname>Kotowicz</surname>
              <given-names>M.A.</given-names>
            </name>
            <name>
              <surname>Seeman</surname>
              <given-names>E.</given-names>
            </name>
          </person-group>
          <article-title>Half the burden of fragility fractures in the community occur in women without osteoporosis. When is fracture prevention cost-effective?</article-title>
          <source>Bone</source>
          <volume>38</volume>
          <issue>5</issue>
          <year>2006</year>
          <fpage>694</fpage>
          <lpage>700</lpage>
          <pub-id pub-id-type="pmid">16507356</pub-id>
        </element-citation>
      </ref>
      <ref id="bib25">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Streekstra</surname>
              <given-names>G.J.</given-names>
            </name>
            <name>
              <surname>Strackee</surname>
              <given-names>S.D.</given-names>
            </name>
            <name>
              <surname>Maas</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>ter Wee</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Venema</surname>
              <given-names>H.W.</given-names>
            </name>
          </person-group>
          <article-title>Model-based cartilage thickness measurement in the submillimeter range</article-title>
          <source>Med. Phys.</source>
          <volume>34</volume>
          <issue>9</issue>
          <year>2007</year>
          <fpage>3562</fpage>
          <lpage>3570</lpage>
          <pub-id pub-id-type="pmid">17926959</pub-id>
        </element-citation>
      </ref>
      <ref id="bib26">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Treece</surname>
              <given-names>G.M.</given-names>
            </name>
            <name>
              <surname>Prager</surname>
              <given-names>R.W.</given-names>
            </name>
            <name>
              <surname>Gee</surname>
              <given-names>A.H.</given-names>
            </name>
          </person-group>
          <article-title>Regularised marching tetrahedra: improved iso-surface extraction</article-title>
          <source>Comput. Graph.</source>
          <volume>23</volume>
          <issue>4</issue>
          <year>1999</year>
          <fpage>583</fpage>
          <lpage>598</lpage>
        </element-citation>
      </ref>
      <ref id="bib27">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Treece</surname>
              <given-names>G.M.</given-names>
            </name>
            <name>
              <surname>Prager</surname>
              <given-names>R.W.</given-names>
            </name>
            <name>
              <surname>Gee</surname>
              <given-names>A.H.</given-names>
            </name>
            <name>
              <surname>Berman</surname>
              <given-names>L.</given-names>
            </name>
          </person-group>
          <article-title>Surface interpolation from sparse cross-sections using region correspondence</article-title>
          <source>IEEE Trans. Med. Imag.</source>
          <volume>19</volume>
          <issue>11</issue>
          <year>2000</year>
          <fpage>1106</fpage>
          <lpage>1114</lpage>
        </element-citation>
      </ref>
      <ref id="bib28">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Uusi-Rasi</surname>
              <given-names>K.</given-names>
            </name>
            <name>
              <surname>Semanick</surname>
              <given-names>L.M.</given-names>
            </name>
            <name>
              <surname>Zanchetta</surname>
              <given-names>J.R.</given-names>
            </name>
            <name>
              <surname>Bogado</surname>
              <given-names>C.E.</given-names>
            </name>
            <name>
              <surname>Eriksen</surname>
              <given-names>E.F.</given-names>
            </name>
            <name>
              <surname>Sato</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Beck</surname>
              <given-names>T.J.</given-names>
            </name>
          </person-group>
          <article-title>Effects of teriparatide [rhPTH (1-34)] treatment on structural geometry of the proximal femur in elderly osteoporotic women</article-title>
          <source>Bone</source>
          <volume>36</volume>
          <issue>6</issue>
          <year>2005</year>
          <fpage>948</fpage>
          <lpage>958</lpage>
          <pub-id pub-id-type="pmid">15878318</pub-id>
        </element-citation>
      </ref>
      <ref id="bib29">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Verhulp</surname>
              <given-names>E.</given-names>
            </name>
            <name>
              <surname>van Rietbergen</surname>
              <given-names>B.</given-names>
            </name>
            <name>
              <surname>Huiskes</surname>
              <given-names>R.</given-names>
            </name>
          </person-group>
          <article-title>Load distribution in the healthy and osteoporotic human proximal femur during a fall to the side</article-title>
          <source>Bone</source>
          <volume>42</volume>
          <issue>1</issue>
          <year>2008</year>
          <fpage>30</fpage>
          <lpage>35</lpage>
          <pub-id pub-id-type="pmid">17977813</pub-id>
        </element-citation>
      </ref>
    </ref-list>
    <ack>
      <title>Acknowledgments</title>
      <p>K. Poole is supported by the Arthritis Research Campaign, the Evelyn Trust and the NIHR Cambridge Biomedical Research Centre. The cadaveric femurs were from the <italic>Melbourne Femur Collection Research Tissue Bank of the Victorian Institute of Forensic Medicine</italic>, with kind permission of Professor John Clement, Australia.</p>
    </ack>
    <fn-group>
      <fn id="fn1">
        <label>1</label>
        <p>These expressions are readily derived by differentiating <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic>(<italic>x</italic>)</textual-form><mml:math id="M72" altimg="si24.gif" overflow="scroll"><mml:mrow><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>g</italic><sub><italic>o</italic></sub>(<italic>x</italic>)</textual-form><mml:math id="M73" altimg="si25.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> to obtain a sequence of <italic>δ</italic>-functions, convolving with <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>g</italic><sub><italic>i</italic></sub>(<italic>x</italic>)</textual-form><mml:math id="M74" altimg="si26.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, and integrating the result. <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub> blur</sub></textual-form><mml:math id="M75" altimg="si27.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.35em" height="0.8ex"/><mml:mtext>blur</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> can then be evaluated by numerical integration of Eq. <xref rid="fd1" ref-type="disp-formula">(5)</xref> or <xref rid="fd2" ref-type="disp-formula">(6)</xref>, which is more computationally efficient than the alternative approach of direct numerical convolution. This is particularly advantageous when <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>blur</sub></textual-form><mml:math id="M76" altimg="si28.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext>blur</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> has to be evaluated a large number of times, as in the Levenberg-Marquardt procedure described in Section <xref rid="sec2" ref-type="sec">2.2</xref>.</p>
      </fn>
      <fn id="fn2">
        <label>2</label>
        <p>
          <ext-link ext-link-type="uri" xlink:href="http://mi.eng.cam.ac.uk/rwp/stradwin">http://mi.eng.cam.ac.uk/rwp/stradwin.</ext-link>
        </p>
      </fn>
      <fn id="fn3">
        <label>3</label>
        <p>Thresholding the blurred, low resolution CT data produces contours that are typically 1–2% larger than the corresponding high resolution contours. Thus, seven degree-of-freedom (DOF) registration gives a slightly better fit than six DOF registration. Exploratory investigations with six DOF registration showed that the subsequent thickness comparisons were not particularly sensitive to the nuances of the registration technique.</p>
      </fn>
      <fn id="fn4">
        <label>4</label>
        <p>It should be noted that the cadaveric femurs were not cleaned before scanning and there was some residual tissue attached to the outer cortical surface. The combination of residual tissue and air may in fact have made the estimation process more difficult, since the exterior CT value <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>0</sub></textual-form><mml:math id="M77" altimg="si80.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> would have been estimated in an area not well characterized by a constant value.</p>
      </fn>
    </fn-group>
  </back>
  <floats-group>
    <fig id="fig1">
      <label>Fig. 1</label>
      <caption>
        <p>The effect of surface orientation and CT slice thickness on the apparent thickness and out-of-plane PSF. A finite CT slice width <italic>s</italic> causes cortical layers oblique to the slice to appear as if they have been blurred with a rectangular PSF, with extent dependent on surface orientation <italic>a</italic>, leading to a piecewise linear image. The true cortical thickness <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>t</italic><sub><italic>r</italic></sub></textual-form><mml:math id="M78" altimg="si1.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> can be expressed as a function of <italic>a</italic> and the measured thickness <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>t</italic><sub><italic>m</italic></sub></textual-form><mml:math id="M79" altimg="si2.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
      </caption>
      <graphic xlink:href="gr1"/>
    </fig>
    <fig id="fig2">
      <label>Fig. 2</label>
      <caption>
        <p>A simulation of the cortical imaging process. The CT value along a line passing through the cortex is simulated by blurring a piecewise constant density function (with CT values of −1000, 1750 and 0) with a Gaussian kernel of standard deviation 1 mm. The solid lines show the underlying and blurred CT values, the dotted lines show a threshold of 600, and the dashed lines show values half way between the appropriate CT baseline and the blurred peak (50% relative threshold). In (a), the cortex is sufficiently wide for thresholding and the 50% relative threshold methods to work correctly. In (b), the threshold still gives approximately the correct thickness, but the 50% relative threshold method overestimates. In (c), no values exceed the threshold, and the 50% relative threshold method now reports the width of the PSF rather than that of the cortex.</p>
      </caption>
      <graphic xlink:href="gr2"/>
    </fig>
    <fig id="fig3">
      <label>Fig. 3</label>
      <caption>
        <p>Cortical thickness in high and low resolution CT data. (a) and (b) show corresponding CT slices from a cadaveric femur scanned at high resolution (Xtreme pQCT, 82 μm/pixel, Scanco Medical AG, Brüttisellen, Switzerland) and low resolution (Siemens Somatom Sensation 64 MDCT, 589 μm/pixel, Siemens AG, Erlangen, Germany). (c) and (d) show the CT values along the lines labelled (1) and (2) in the images. In (c), the cortical layer is sufficiently thick to show a significant peak in the low resolution data. In (d), the thickness is somewhat less, and in this case there is only a very shallow peak in the low resolution data. Also shown in (c) and (d) are the best fit models <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>blur</sub></textual-form><mml:math id="M80" altimg="si3.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext>blur</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and the corresponding piecewise constant density functions.</p>
      </caption>
      <graphic xlink:href="gr3"/>
    </fig>
    <fig id="fig4">
      <label>Fig. 4</label>
      <caption>
        <p>Discrimination of cortical and trabecular bone peaks for the half-max and threshold methods. (a) and (b) are two examples from the high resolution data showing how the model-fitting process establishes which peaks are within the cortex. The upper plots correspond to the half-max method, the lower plots to the threshold method. The model-fitting algorithm optimally (in a least squares sense) divides the data into spans of higher (cortical) and lower (trabecular, exterior) density values. For the half-max method, the boundaries tend to be positioned very close to the half way point between the cortical and trabecular/exterior values. For the threshold method, the boundaries are positioned precisely on one of the threshold crossing points.</p>
      </caption>
      <graphic xlink:href="gr4"/>
    </fig>
    <fig id="fig5">
      <label>Fig. 5</label>
      <caption>
        <p>Creation of the surface and the use of surface normals for guiding thickness estimation. A surface is generated by thresholding the entire data set, then extracting contours in each plane to sub-pixel resolution. Contours are then locally edited (a) to correct erroneously excluded regions and (b) to remove any adjoining structures. A surface is interpolated through these contours, and the surface vertices and normals used to guide the in-plane thickness estimation. (c) The surface normals are shown in cyan, cortical edges as red dots, and the plot shows the thickness estimation process for the red line at the bottom.</p>
      </caption>
      <graphic xlink:href="gr5"/>
    </fig>
    <fig id="fig6">
      <label>Fig. 6</label>
      <caption>
        <p>Mapping and filtering of high resolution thickness estimates. (a) Once cortical thickness has been estimated at each vertex, this is mapped back onto the surface as a colour. (b) The high resolution thickness map is filtered over the surface, such that the spatial resolution of the map is approximately equivalent to that of the low resolution data.</p>
      </caption>
      <graphic xlink:href="gr6"/>
    </fig>
    <fig id="fig7">
      <label>Fig. 7</label>
      <caption>
        <p>Co-registration of high and low resolution surfaces. High resolution (a) and low resolution (b) surfaces are aligned using manual registration followed by the ICP algorithm. (c) The registered surfaces. (d) Point-wise alignment discrepancies are generally well below 1 mm.</p>
      </caption>
      <graphic xlink:href="gr7"/>
    </fig>
    <fig id="fig8">
      <label>Fig. 8</label>
      <caption>
        <p>Distribution of cortical thickness and errors across all 16 cadaveric data sets. The top graph shows the thickness distribution derived from the high resolution data. The bottom graph shows the error distribution for the ‘new variable’ measurement method. Despite the narrow peak, there are outlying errors up to ±15 mm. The dotted lines indicate the 4 mm limits used to exclude poor matches (less than 3% of the total) from some of the subsequent error analysis.</p>
      </caption>
      <graphic xlink:href="gr8"/>
    </fig>
    <fig id="fig9">
      <label>Fig. 9</label>
      <caption>
        <p>Difficulties comparing low and high resolution thickness measurements. (a) and (b) show corresponding high and low resolution slices through the CT data. (c) and (d) are plots of the CT values along the lines labelled (1) and (2) respectively. In (c), the surface normal in the high resolution data is not compatible with that of the low resolution data. In (d), there is ambiguity in the definition of cortical thickness: both estimators detect the outermost resolvable layer, but this layer is not the same at the two resolutions.</p>
      </caption>
      <graphic xlink:href="gr9"/>
    </fig>
    <fig id="fig10">
      <label>Fig. 10</label>
      <caption>
        <p>Thickness estimation on simulated data with different values of cortical thickness in the range 0.2–5.5 mm. The CT value along a line passing through the cortical layer was simulated by blurring a piecewise constant density function with a Gaussian kernel of standard deviation 1.25 mm. The unblurred cortical density was set to 1750 HU and the trabecular density to 0 HU. The cortical thickness was then estimated using a variety of techniques: the half-max method, thresholding at different CT values from 300 HU to 1700 HU, and the new method assuming cortical CT values <inline-formula><alternatives><textual-form specific-use="jats-markup">(<italic>y</italic><sub>1</sub>)</textual-form><mml:math id="M81" altimg="si4.gif" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> in the range 1300 HU to 2200 HU. The results are presented as follows. There is a single dot-dashed line for the half-max method, one dotted line for each threshold value (thresholding method), and one dashed line for each assumed cortical CT value (new method). (a) shows a simulated scan in air (unblurred extra-cortical density of −1000 HU) and (b) shows an in vivo simulation (unblurred extra-cortical density of 0 HU). In both cases, the half-max method overestimates at low thicknesses. Thresholding gives better results for carefully chosen thresholds: note how the optimal threshold varies significantly from 600 HU in (a) to 800 HU in (b). The new method gives consistently good results, with relatively little sensitivity to the assumed cortical CT value: the dashed lines are grouped closely around the main diagonal.</p>
      </caption>
      <graphic xlink:href="gr10"/>
    </fig>
    <fig id="fig11">
      <label>Fig. 11</label>
      <caption>
        <p>Cadaveric cortical thickness estimation as a function of thickness. The upper graph in each case shows the mean ± 1 standard deviation of <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>t</italic><sub><italic>l</italic></sub></textual-form><mml:math id="M82" altimg="si5.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> on the <italic>y</italic>-axis, for each 0.1 mm band of <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>t</italic><sub><italic>h</italic></sub></textual-form><mml:math id="M83" altimg="si6.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> on the <italic>x</italic>-axis. This is similar to the presentation used for the simulated data in <xref rid="fig10" ref-type="fig">Fig. 10</xref>. The lower graph indicates the percentage of successful thickness estimates in each band. (a) shows results for the best case (473), (b) for the worst (467) and (c) the combined results across all 16 femurs. The three colours have been rendered with some transparency, so the ±1 standard deviation ranges remain distinguishable where they overlap. At low thicknesses, the half-max and threshold results are not what one would expect from the model (<xref rid="fig10" ref-type="fig">Fig. 10</xref>). We discuss possible reasons for this in Section <xref rid="sec7" ref-type="sec">4</xref>.</p>
      </caption>
      <graphic xlink:href="gr11"/>
    </fig>
    <fig id="fig12">
      <label>Fig. 12</label>
      <caption>
        <p>Thickness estimation for the best case (473). (a)–(d) are thickness maps from the front, (h)–(k) from the back. (e)–(g) and (l)–(n) are absolute thickness error maps. The first column (a, h) shows the high resolution ‘ground truth’ measurements. The second column (b, e, i, l) shows the thresholding results, the third column (c, f, j, m) half-max, and the fourth column (d, g, k, n) the ‘new variable’ results.</p>
      </caption>
      <graphic xlink:href="gr12"/>
    </fig>
    <fig id="fig13">
      <label>Fig. 13</label>
      <caption>
        <p>Thickness estimation for the worst case (467). (a)–(d) are thickness maps from the front, (h)–(k) from the back. (e)–(g) and (l)–(n) are absolute thickness error maps. The first column (a, h) shows the high resolution ‘ground truth’ measurements. The second column (b, e, i, l) shows the thresholding results, the third column (c, f, j, m) half-max, and the fourth column (d, g, k, n) the ‘new variable’ results.</p>
      </caption>
      <graphic xlink:href="gr13"/>
    </fig>
    <fig id="fig14">
      <label>Fig. 14</label>
      <caption>
        <p>Cortical thickness estimation for an 87-year old male volunteer with a sub-capital femoral neck fracture. The maps were produced using the ‘new variable’ method. (a) and (b) show the contralateral and fractured femurs from the back, (c) and (d) from the front. This demonstrates the feasibility of estimating cortical thickness maps in vivo, even for fractured femurs. The fractured and contralateral maps are reassuringly similar.</p>
      </caption>
      <graphic xlink:href="gr14"/>
    </fig>
    <fig id="fig15">
      <label>Fig. 15</label>
      <caption>
        <p>Cortical thickness estimation at 1 mm and 3 mm CT slice thickness for a 39-year old female volunteer. The maps were produced using the ‘new variable’ method. (a) and (b) are estimates from CT data reconstructed at 1 mm slice thickness, (c) and (d) from the same data reconstructed at 3 mm slice thickness. (e) and (f) are absolute difference maps, revealing very few discrepancies between the two sets of results.</p>
      </caption>
      <graphic xlink:href="gr15"/>
    </fig>
    <table-wrap id="tbl1" position="float">
      <label>Table 1</label>
      <caption>
        <p>Summary statistics for the 16 cadaveric femur data sets. <italic>N</italic> is the number of vertices on the low resolution surfaces for which a corresponding ‘ground truth’ thickness is available. ‘Percentage success’ indicates how frequently each method produced any sort of thickness estimate. The final column shows the assumed cortical CT value used for the ‘new variable’ method. The ‘new fixed’ method assumed a value of 1750 HU throughout.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th rowspan="2">ID</th>
            <th rowspan="2">Sex</th>
            <th rowspan="2">Age</th>
            <th rowspan="2">Wt. (kg)</th>
            <th rowspan="2">Ht. (cm)</th>
            <th rowspan="2">
              <italic>N</italic>
            </th>
            <th colspan="4">Percentage success<hr/></th>
            <th rowspan="2"><inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>y</italic><sub>1</sub></textual-form><mml:math id="M84" altimg="si7.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> (HU)</th>
          </tr>
          <tr>
            <th>Half-max</th>
            <th>Threshold</th>
            <th>New fixed</th>
            <th>New variable</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>443</td>
            <td>F</td>
            <td>74</td>
            <td align="char">69</td>
            <td>160</td>
            <td>17,794</td>
            <td align="char">99.92</td>
            <td align="char">76.72</td>
            <td align="char">99.97</td>
            <td align="char">99.97</td>
            <td>1750</td>
          </tr>
          <tr>
            <td>456</td>
            <td>F</td>
            <td>68</td>
            <td align="char">53</td>
            <td>167</td>
            <td>16,732</td>
            <td align="char">99.93</td>
            <td align="char">78.53</td>
            <td align="char">99.92</td>
            <td align="char">99.90</td>
            <td>1800</td>
          </tr>
          <tr>
            <td>457</td>
            <td>F</td>
            <td>75</td>
            <td align="char">69</td>
            <td>153</td>
            <td>16,267</td>
            <td align="char">99.70</td>
            <td align="char">54.60</td>
            <td align="char">99.63</td>
            <td align="char">99.50</td>
            <td>1760</td>
          </tr>
          <tr>
            <td>458</td>
            <td>F</td>
            <td>66</td>
            <td align="char">77</td>
            <td>167</td>
            <td>18,989</td>
            <td align="char">99.95</td>
            <td align="char">76.47</td>
            <td align="char">99.95</td>
            <td align="char">99.95</td>
            <td>1680</td>
          </tr>
          <tr>
            <td>464</td>
            <td>M</td>
            <td>19</td>
            <td align="char">66</td>
            <td>164</td>
            <td>17,873</td>
            <td align="char">99.47</td>
            <td align="char">73.87</td>
            <td align="char">99.13</td>
            <td align="char">99.13</td>
            <td>1820</td>
          </tr>
          <tr>
            <td>465</td>
            <td>F</td>
            <td>77</td>
            <td align="char">56</td>
            <td>150</td>
            <td>17,233</td>
            <td align="char">99.76</td>
            <td align="char">63.31</td>
            <td align="char">99.53</td>
            <td align="char">99.47</td>
            <td>1710</td>
          </tr>
          <tr>
            <td>466</td>
            <td>F</td>
            <td>63</td>
            <td align="char">62</td>
            <td>148</td>
            <td>15,154</td>
            <td align="char">99.85</td>
            <td align="char">46.21</td>
            <td align="char">99.95</td>
            <td align="char">99.97</td>
            <td>1900</td>
          </tr>
          <tr>
            <td>467</td>
            <td>F</td>
            <td>41</td>
            <td align="char">104</td>
            <td>179</td>
            <td>17,194</td>
            <td align="char">99.92</td>
            <td align="char">86.73</td>
            <td align="char">99.71</td>
            <td align="char">99.74</td>
            <td>1720</td>
          </tr>
          <tr>
            <td>470</td>
            <td>F</td>
            <td>80</td>
            <td align="char">69</td>
            <td>157</td>
            <td>19,302</td>
            <td align="char">99.90</td>
            <td align="char">73.73</td>
            <td align="char">99.77</td>
            <td align="char">99.77</td>
            <td>1780</td>
          </tr>
          <tr>
            <td>473</td>
            <td>F</td>
            <td>42</td>
            <td align="char">58</td>
            <td>173</td>
            <td>16,612</td>
            <td align="char">99.95</td>
            <td align="char">81.73</td>
            <td align="char">99.72</td>
            <td align="char">99.82</td>
            <td>1820</td>
          </tr>
          <tr>
            <td>474</td>
            <td>M</td>
            <td>21</td>
            <td align="char">74</td>
            <td>182</td>
            <td>20,324</td>
            <td align="char">99.92</td>
            <td align="char">69.13</td>
            <td align="char">99.94</td>
            <td align="char">99.94</td>
            <td>1750</td>
          </tr>
          <tr>
            <td>477</td>
            <td>F</td>
            <td>47</td>
            <td align="char">83</td>
            <td>163</td>
            <td>16,798</td>
            <td align="char">99.76</td>
            <td align="char">72.22</td>
            <td align="char">99.54</td>
            <td align="char">99.77</td>
            <td>1810</td>
          </tr>
          <tr>
            <td>483</td>
            <td>F</td>
            <td>40</td>
            <td align="char">42</td>
            <td>152</td>
            <td>11,722</td>
            <td align="char">99.90</td>
            <td align="char">86.86</td>
            <td align="char">99.85</td>
            <td align="char">99.86</td>
            <td>1850</td>
          </tr>
          <tr>
            <td>485</td>
            <td>F</td>
            <td>40</td>
            <td align="char">63</td>
            <td>167</td>
            <td>18,537</td>
            <td align="char">99.76</td>
            <td align="char">60.35</td>
            <td align="char">99.88</td>
            <td align="char">99.83</td>
            <td>1720</td>
          </tr>
          <tr>
            <td>493</td>
            <td>M</td>
            <td>70</td>
            <td align="char">79</td>
            <td>161</td>
            <td>19,436</td>
            <td align="char">99.92</td>
            <td align="char">72.93</td>
            <td align="char">99.91</td>
            <td align="char">99.89</td>
            <td>1720</td>
          </tr>
          <tr>
            <td>494</td>
            <td>M</td>
            <td>83</td>
            <td align="char">60</td>
            <td>157</td>
            <td>19,012</td>
            <td align="char">99.95</td>
            <td align="char">67.42</td>
            <td align="char">99.88</td>
            <td align="char">99.92</td>
            <td>1660</td>
          </tr>
          <tr>
            <td>All</td>
            <td>–</td>
            <td>–</td>
            <td>–</td>
            <td>–</td>
            <td>–</td>
            <td align="char">99.85</td>
            <td align="char">71.18</td>
            <td align="char">99.77</td>
            <td align="char">99.78</td>
            <td>–</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <table-wrap id="tbl2" position="float">
      <label>Table 2</label>
      <caption>
        <p>Cortical thickness estimation error, considering the entire range of errors and thicknesses. The tabulated quantity is the mean and standard deviation of <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>t</italic><sub><italic>l</italic></sub> - <italic>t</italic><sub><italic>h</italic></sub></textual-form><mml:math id="M85" altimg="si8.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, for all successful low resolution thickness estimates for which a high resolution match could be found.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th rowspan="2">ID</th>
            <th colspan="4">Mean error ± 1 std.dev. (mm)<hr/></th>
          </tr>
          <tr>
            <th>Half-max</th>
            <th>Threshold</th>
            <th>New fixed</th>
            <th>New variable</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>443</td>
            <td align="char">1.17 ± 1.29</td>
            <td align="char">0.36 ± 1.18</td>
            <td align="char">0.19 ± 0.82</td>
            <td align="char">0.19 ± 0.82</td>
          </tr>
          <tr>
            <td>456</td>
            <td align="char">0.92 ± 1.31</td>
            <td align="char">0.67 ± 2.07</td>
            <td align="char">0.00 ± 0.89</td>
            <td align="char">−0.05 ± 0.87</td>
          </tr>
          <tr>
            <td>457</td>
            <td align="char">1.18 ± 2.39</td>
            <td align="char">0.14 ± 0.64</td>
            <td align="char">0.07 ± 0.74</td>
            <td align="char">0.07 ± 0.83</td>
          </tr>
          <tr>
            <td>458</td>
            <td align="char">1.23 ± 1.32</td>
            <td align="char">0.36 ± 1.20</td>
            <td align="char">0.12 ± 0.74</td>
            <td align="char">0.21 ± 0.78</td>
          </tr>
          <tr>
            <td>464</td>
            <td align="char">1.10 ± 1.05</td>
            <td align="char">0.47 ± 0.75</td>
            <td align="char">0.10 ± 0.54</td>
            <td align="char">0.05 ± 0.55</td>
          </tr>
          <tr>
            <td>465</td>
            <td align="char">0.95 ± 1.18</td>
            <td align="char">0.24 ± 0.96</td>
            <td align="char">0.02 ± 0.68</td>
            <td align="char">0.07 ± 0.71</td>
          </tr>
          <tr>
            <td>466</td>
            <td align="char">1.28 ± 3.91</td>
            <td align="char">0.18 ± 0.81</td>
            <td align="char">0.07 ± 0.52</td>
            <td align="char">−0.02 ± 0.53</td>
          </tr>
          <tr>
            <td>467</td>
            <td align="char">0.74 ± 1.52</td>
            <td align="char">0.40 ± 1.80</td>
            <td align="char">−0.15 ± 1.19</td>
            <td align="char">−0.14 ± 1.15</td>
          </tr>
          <tr>
            <td>470</td>
            <td align="char">1.16 ± 1.47</td>
            <td align="char">0.30 ± 1.16</td>
            <td align="char">0.05 ± 0.77</td>
            <td align="char">0.05 ± 0.77</td>
          </tr>
          <tr>
            <td>473</td>
            <td align="char">1.02 ± 0.86</td>
            <td align="char">0.47 ± 0.94</td>
            <td align="char">0.13 ± 0.47</td>
            <td align="char">0.07 ± 0.45</td>
          </tr>
          <tr>
            <td>474</td>
            <td align="char">1.09 ± 1.21</td>
            <td align="char">0.40 ± 1.34</td>
            <td align="char">−0.09 ± 0.58</td>
            <td align="char">−0.09 ± 0.58</td>
          </tr>
          <tr>
            <td>477</td>
            <td align="char">0.77 ± 1.06</td>
            <td align="char">0.22 ± 0.84</td>
            <td align="char">0.00 ± 0.72</td>
            <td align="char">−0.08 ± 0.67</td>
          </tr>
          <tr>
            <td>483</td>
            <td align="char">0.96 ± 1.32</td>
            <td align="char">0.35 ± 1.32</td>
            <td align="char">0.12 ± 0.88</td>
            <td align="char">0.01 ± 0.81</td>
          </tr>
          <tr>
            <td>485</td>
            <td align="char">1.12 ± 1.80</td>
            <td align="char">0.03 ± 0.50</td>
            <td align="char">−0.12 ± 0.52</td>
            <td align="char">−0.08 ± 0.48</td>
          </tr>
          <tr>
            <td>493</td>
            <td align="char">1.14 ± 1.35</td>
            <td align="char">0.29 ± 1.05</td>
            <td align="char">−0.03 ± 0.62</td>
            <td align="char">0.00 ± 0.62</td>
          </tr>
          <tr>
            <td>494</td>
            <td align="char">0.94 ± 2.07</td>
            <td align="char">0.68 ± 2.22</td>
            <td align="char">0.00 ± 1.39</td>
            <td align="char">0.02 ± 1.17</td>
          </tr>
          <tr>
            <td>All</td>
            <td align="char">1.05 ± 1.70</td>
            <td align="char">0.36 ± 1.31</td>
            <td align="char">0.03 ± 0.80</td>
            <td align="char">0.02 ± 0.77</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <table-wrap id="tbl3" position="float">
      <label>Table 3</label>
      <caption>
        <p>Cortical thickness estimation error, for errors below 4 mm and the entire range of thicknesses. The tabulated quantity is the mean and standard deviation of <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>t</italic><sub><italic>l</italic></sub> - <italic>t</italic><sub><italic>h</italic></sub></textual-form><mml:math id="M86" altimg="si9.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. By ignoring the very small number of errors above 4 mm, the results might better reflect the merits of the various techniques and not the evaluation shortcomings identified in <xref rid="fig9" ref-type="fig">Fig. 9</xref>.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th rowspan="2">ID</th>
            <th colspan="4">Mean error ± 1 std.dev. (mm)<hr/></th>
          </tr>
          <tr>
            <th>Half-max</th>
            <th>Threshold</th>
            <th>New fixed</th>
            <th>New variable</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>443</td>
            <td align="char">1.02 ± 0.90</td>
            <td align="char">0.28 ± 0.71</td>
            <td align="char">0.16 ± 0.61</td>
            <td align="char">0.16 ± 0.61</td>
          </tr>
          <tr>
            <td>456</td>
            <td align="char">0.78 ± 0.91</td>
            <td align="char">0.38 ± 0.77</td>
            <td align="char">−0.06 ± 0.61</td>
            <td align="char">−0.11 ± 0.60</td>
          </tr>
          <tr>
            <td>457</td>
            <td align="char">1.04 ± 0.83</td>
            <td align="char">0.14 ± 0.56</td>
            <td align="char">0.03 ± 0.48</td>
            <td align="char">0.03 ± 0.47</td>
          </tr>
          <tr>
            <td>458</td>
            <td align="char">1.05 ± 0.83</td>
            <td align="char">0.29 ± 0.65</td>
            <td align="char">0.10 ± 0.57</td>
            <td align="char">0.17 ± 0.58</td>
          </tr>
          <tr>
            <td>464</td>
            <td align="char">1.02 ± 0.85</td>
            <td align="char">0.43 ± 0.54</td>
            <td align="char">0.09 ± 0.48</td>
            <td align="char">0.04 ± 0.47</td>
          </tr>
          <tr>
            <td>465</td>
            <td align="char">0.84 ± 0.87</td>
            <td align="char">0.20 ± 0.68</td>
            <td align="char">0.02 ± 0.59</td>
            <td align="char">0.06 ± 0.60</td>
          </tr>
          <tr>
            <td>466</td>
            <td align="char">1.09 ± 0.90</td>
            <td align="char">0.17 ± 0.56</td>
            <td align="char">0.06 ± 0.46</td>
            <td align="char">−0.02 ± 0.44</td>
          </tr>
          <tr>
            <td>467</td>
            <td align="char">0.59 ± 1.06</td>
            <td align="char">0.17 ± 0.93</td>
            <td align="char">−0.21 ± 0.84</td>
            <td align="char">−0.18 ± 0.85</td>
          </tr>
          <tr>
            <td>470</td>
            <td align="char">0.94 ± 0.94</td>
            <td align="char">0.21 ± 0.64</td>
            <td align="char">0.02 ± 0.56</td>
            <td align="char">0.02 ± 0.56</td>
          </tr>
          <tr>
            <td>473</td>
            <td align="char">0.97 ± 0.74</td>
            <td align="char">0.40 ± 0.61</td>
            <td align="char">0.12 ± 0.43</td>
            <td align="char">0.07 ± 0.42</td>
          </tr>
          <tr>
            <td>474</td>
            <td align="char">1.00 ± 0.94</td>
            <td align="char">0.29 ± 0.68</td>
            <td align="char">−0.09 ± 0.51</td>
            <td align="char">−0.09 ± 0.51</td>
          </tr>
          <tr>
            <td>477</td>
            <td align="char">0.68 ± 0.77</td>
            <td align="char">0.18 ± 0.65</td>
            <td align="char">−0.01 ± 0.57</td>
            <td align="char">−0.09 ± 0.55</td>
          </tr>
          <tr>
            <td>483</td>
            <td align="char">0.83 ± 0.96</td>
            <td align="char">0.30 ± 0.82</td>
            <td align="char">0.05 ± 0.59</td>
            <td align="char">−0.04 ± 0.58</td>
          </tr>
          <tr>
            <td>485</td>
            <td align="char">1.00 ± 1.00</td>
            <td align="char">0.02 ± 0.46</td>
            <td align="char">−0.12 ± 0.46</td>
            <td align="char">−0.08 ± 0.45</td>
          </tr>
          <tr>
            <td>493</td>
            <td align="char">0.96 ± 0.93</td>
            <td align="char">0.23 ± 0.61</td>
            <td align="char">−0.04 ± 0.55</td>
            <td align="char">−0.01 ± 0.54</td>
          </tr>
          <tr>
            <td>494</td>
            <td align="char">0.48 ± 0.93</td>
            <td align="char">0.23 ± 0.79</td>
            <td align="char">−0.18 ± 0.70</td>
            <td align="char">−0.09 ± 0.73</td>
          </tr>
          <tr>
            <td>All</td>
            <td align="char">0.90 ± 0.92</td>
            <td align="char">0.25 ± 0.69</td>
            <td align="char">−0.01 ± 0.58</td>
            <td align="char">−0.01 ± 0.58</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <table-wrap id="tbl4" position="float">
      <label>Table 4</label>
      <caption>
        <p>Cortical thickness estimation error, for errors below 4 mm and thicknesses in the range 0.3–2 mm. The tabulated quantity is the mean and standard deviation of <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>t</italic><sub><italic>l</italic></sub> - <italic>t</italic><sub><italic>h</italic></sub></textual-form><mml:math id="M87" altimg="si10.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. The areas of most clinical interest are likely to be those where the cortex is particularly thin. Significantly, it is in precisely these areas that the various estimation techniques differ most in terms of performance.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th rowspan="2">ID</th>
            <th colspan="4">Mean error ± 1 std.dev. (mm)<hr/></th>
          </tr>
          <tr>
            <th>Half-max</th>
            <th>Threshold</th>
            <th>New fixed</th>
            <th>New variable</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>443</td>
            <td align="char">1.43 ± 0.74</td>
            <td align="char">0.19 ± 0.58</td>
            <td align="char">0.14 ± 0.48</td>
            <td align="char">0.14 ± 0.48</td>
          </tr>
          <tr>
            <td>456</td>
            <td align="char">1.16 ± 0.83</td>
            <td align="char">0.26 ± 0.73</td>
            <td align="char">−0.04 ± 0.51</td>
            <td align="char">−0.07 ± 0.49</td>
          </tr>
          <tr>
            <td>457</td>
            <td align="char">1.29 ± 0.73</td>
            <td align="char">0.06 ± 0.44</td>
            <td align="char">0.06 ± 0.43</td>
            <td align="char">0.05 ± 0.43</td>
          </tr>
          <tr>
            <td>458</td>
            <td align="char">1.39 ± 0.70</td>
            <td align="char">0.24 ± 0.60</td>
            <td align="char">0.12 ± 0.48</td>
            <td align="char">0.17 ± 0.50</td>
          </tr>
          <tr>
            <td>464</td>
            <td align="char">1.24 ± 0.84</td>
            <td align="char">0.35 ± 0.53</td>
            <td align="char">0.06 ± 0.48</td>
            <td align="char">0.03 ± 0.47</td>
          </tr>
          <tr>
            <td>465</td>
            <td align="char">1.10 ± 0.83</td>
            <td align="char">−0.06 ± 0.47</td>
            <td align="char">−0.02 ± 0.45</td>
            <td align="char">0.00 ± 0.47</td>
          </tr>
          <tr>
            <td>466</td>
            <td align="char">1.37 ± 0.83</td>
            <td align="char">0.00 ± 0.41</td>
            <td align="char">0.03 ± 0.41</td>
            <td align="char">−0.02 ± 0.39</td>
          </tr>
          <tr>
            <td>467</td>
            <td align="char">1.19 ± 0.76</td>
            <td align="char">0.18 ± 0.72</td>
            <td align="char">0.07 ± 0.48</td>
            <td align="char">0.10 ± 0.49</td>
          </tr>
          <tr>
            <td>470</td>
            <td align="char">1.33 ± 0.82</td>
            <td align="char">0.19 ± 0.65</td>
            <td align="char">0.07 ± 0.51</td>
            <td align="char">0.07 ± 0.51</td>
          </tr>
          <tr>
            <td>473</td>
            <td align="char">1.26 ± 0.65</td>
            <td align="char">0.39 ± 0.67</td>
            <td align="char">0.13 ± 0.41</td>
            <td align="char">0.09 ± 0.39</td>
          </tr>
          <tr>
            <td>474</td>
            <td align="char">1.29 ± 0.88</td>
            <td align="char">0.17 ± 0.61</td>
            <td align="char">−0.07 ± 0.43</td>
            <td align="char">−0.07 ± 0.43</td>
          </tr>
          <tr>
            <td>477</td>
            <td align="char">0.98 ± 0.67</td>
            <td align="char">0.14 ± 0.54</td>
            <td align="char">−0.04 ± 0.42</td>
            <td align="char">−0.07 ± 0.38</td>
          </tr>
          <tr>
            <td>483</td>
            <td align="char">1.32 ± 0.81</td>
            <td align="char">0.36 ± 0.73</td>
            <td align="char">0.13 ± 0.54</td>
            <td align="char">0.07 ± 0.52</td>
          </tr>
          <tr>
            <td>485</td>
            <td align="char">1.32 ± 0.95</td>
            <td align="char">−0.11 ± 0.40</td>
            <td align="char">−0.12 ± 0.44</td>
            <td align="char">−0.10 ± 0.44</td>
          </tr>
          <tr>
            <td>493</td>
            <td align="char">1.29 ± 0.89</td>
            <td align="char">0.19 ± 0.65</td>
            <td align="char">−0.01 ± 0.50</td>
            <td align="char">0.00 ± 0.50</td>
          </tr>
          <tr>
            <td>494</td>
            <td align="char">0.71 ± 0.93</td>
            <td align="char">0.17 ± 0.70</td>
            <td align="char">−0.22 ± 0.54</td>
            <td align="char">−0.19 ± 0.54</td>
          </tr>
          <tr>
            <td>All</td>
            <td align="char">1.24 ± 0.83</td>
            <td align="char">0.19 ± 0.62</td>
            <td align="char">0.01 ± 0.48</td>
            <td align="char">0.01 ± 0.47</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </floats-group>
</article>